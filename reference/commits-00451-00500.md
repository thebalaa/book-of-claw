# Commit Reference: 00451–00500

A plain factual summary of every commit in the OpenClaw repository, from commit 451 through commit 500.

---

## 00451 — docs: note trimmy-style restart and dimming
**SHA:** 2e393b7d5c · **Date:** 2025-12-06 01:15
**Files changed:** AGENTS.md
**Tags:** `documentation`

Documents menubar dimming and restart flow that mirrors Trimmy pattern: uses scripts/restart-mac.sh to kill Clawdis variants, run swift build, package, and relaunch. Icon dimming depends on MenuBarExtraAccess wiring in AppMain.

---

## 00452 — chore(mac): label toggle as Clawdis Active
**SHA:** 3a32b83181 · **Date:** 2025-12-06 01:17
**Files changed:** Macintosh project file
**Tags:** `ux`

Renames the toggle label from generic to "Clawdis Active" for clarity in the macOS app UI.

---

## 00453 — Discord: CV2! (#16364)
**SHA:** 9203a2fdb1 · **Date:** 2026-02-15 10:24
**Files changed:** Discord integration files
**Tags:** `provider`

Updates Discord provider to support CV2 with appropriate parameter changes and API compatibility adjustments.

---

## 00454 — refactor(agents): dedupe memory tool config
**SHA:** 95355ba25a · **Date:** 2026-02-15 16:22
**Files changed:** src/agents/shared.ts
**Tags:** `refactor`

Consolidates duplicated memory tool configuration logic by extracting shared patterns from agent initialization code.

---

## 00455 — refactor(infra): dedupe update checkout step
**SHA:** e89c7b7735 · **Date:** 2026-02-15 16:21
**Files changed:** src/infra/update.ts
**Tags:** `refactor`

Removes duplicate logic in the update process checkout step by sharing the implementation across multiple providers.

---

## 00456 — refactor(telegram): dedupe media download
**SHA:** 6b65a055e6 · **Date:** 2026-02-15 16:21
**Files changed:** src/telegram/media.ts
**Tags:** `refactor`

Consolidates media download logic in Telegram provider to eliminate redundant implementation patterns across different media types.

---

## 00457 — fix(telegram): restore thread_id=1 handling for DMs (regression from 19b8416a8) (#10942)
**SHA:** cc0bfa0f39 · **Date:** 2026-02-16 00:21
**Files changed:** src/telegram/dispatch.ts
**Tags:** `bugfix`

Fixes regression where direct message thread handling broke; restores proper thread_id=1 logic for DM conversations in Telegram.

---

## 00458 — refactor(gateway): share host header parsing
**SHA:** 1843bcf1db · **Date:** 2026-02-15 16:15
**Files changed:** src/gateway/http.ts
**Tags:** `refactor`

Extracts host header parsing logic into a shared utility to avoid duplication across gateway request handlers.

---

## 00459 — refactor(telegram): dedupe group auth checks
**SHA:** 933a9945ae · **Date:** 2026-02-15 16:12
**Files changed:** src/telegram/auth.ts
**Tags:** `refactor`

Consolidates group authentication checks in Telegram provider to remove duplicate validation logic.

---

## 00460 — refactor(browser): dedupe request record lookup
**SHA:** 234d69f83f · **Date:** 2026-02-15 16:11
**Files changed:** src/browser/requests.ts
**Tags:** `refactor`

Centralizes request record lookup logic in browser automation to eliminate redundant queries across multiple code paths.

---

## 00461 — refactor(hooks): dedupe gmail option types
**SHA:** 77db65d669 · **Date:** 2026-02-15 16:10
**Files changed:** src/hooks/gmail.ts
**Tags:** `refactor`

Removes duplicate Gmail option type definitions by consolidating into shared type definitions.

---

## 00462 — refactor(outbound): dedupe delivery mirror type
**SHA:** c3340a3894 · **Date:** 2026-02-15 16:09
**Files changed:** src/outbound/mirror.ts
**Tags:** `refactor`

Consolidates duplicate delivery mirror type logic by sharing type assertions across mirror implementations.

---

## 00463 — refactor(discord): dedupe application fetch
**SHA:** 41d053a06f · **Date:** 2026-02-15 16:08
**Files changed:** src/discord/applications.ts
**Tags:** `refactor`

Removes duplicate Discord application fetching logic by creating a single shared fetcher function.

---

## 00464 — refactor(infra): share login shell env exec
**SHA:** 47462eed68 · **Date:** 2026-02-15 16:06
**Files changed:** src/infra/exec.ts
**Tags:** `refactor`

Extracts login shell environment execution into a shared utility used by multiple exec providers.

---

## 00465 — refactor(infra): dedupe exec allowlist analysis failure
**SHA:** e7f65b4aac · **Date:** 2026-02-15 16:05
**Files changed:** src/infra/allowlist.ts
**Tags:** `refactor`

Consolidates duplicate exec allowlist analysis failure handling into a single error path.

---

## 00466 — refactor(gateway): share device signature reject path
**SHA:** 7323953ab0 · **Date:** 2026-02-15 16:04
**Files changed:** src/gateway/device.ts
**Tags:** `refactor`

Extracts device signature rejection logic into a shared function to remove code duplication.

---

## 00467 — refactor(gateway): dedupe wizard status schema
**SHA:** cd225c15be · **Date:** 2026-02-15 16:03
**Files changed:** src/gateway/wizard.ts
**Tags:** `refactor`

Consolidates duplicate wizard status schema definitions into a single source of truth.

---

## 00468 — refactor(slack): dedupe event system-event emit
**SHA:** afc333cc5b · **Date:** 2026-02-15 16:01
**Files changed:** src/slack/events.ts
**Tags:** `refactor`

Removes duplicate event emission logic in Slack provider by consolidating system event handlers.

---

## 00469 — refactor(test): dedupe slack slash mocks
**SHA:** 30eacd36af · **Date:** 2026-02-15 15:57
**Files changed:** src/test/slack-slash.ts
**Tags:** `refactor`, `testing`

Consolidates duplicated Slack slash command test mocks into shared test fixtures.

---

## 00470 — fix: allow agent workspace directories in media local roots (#17136)
**SHA:** e927fd1e35 · **Date:** 2026-02-15 10:53
**Files changed:** src/media/roots.ts
**Tags:** `bugfix`

Expands media local roots to include agent workspace directories, allowing media attachments from workspace contexts.

---

## 00471 — refactor(test): share google assistant message builders
**SHA:** 0c57f5e62e · **Date:** 2026-02-15 15:50
**Files changed:** src/test/google-assistant.ts
**Tags:** `refactor`, `testing`

Extracts Google Assistant message builder test utilities into shared test helpers.

---

## 00472 — refactor(test): share sandbox fs bridge builder
**SHA:** c6c6e9f741 · **Date:** 2026-02-15 15:47
**Files changed:** src/test/sandbox.ts
**Tags:** `refactor`, `testing`

Consolidates sandbox filesystem bridge builder into shared test harness to reduce test duplication.

---

## 00473 — Fix/agent session key normalization (#15707)
**SHA:** df95ddc771 · **Date:** 2026-02-15 12:46
**Files changed:** src/agents/sessions.ts
**Tags:** `bugfix`

Fixes agent session key normalization to properly handle edge cases in session identifier hashing.

---

## 00474 — refactor(test): dedupe cron legacy job setup
**SHA:** 75d22b2164 · **Date:** 2026-02-15 15:46
**Files changed:** src/test/cron.ts
**Tags:** `refactor`, `testing`

Consolidates duplicate cron legacy job setup logic in test fixtures.

---

## 00475 — refactor(test): share server chat event harness
**SHA:** e687ad15ac · **Date:** 2026-02-15 15:44
**Files changed:** src/test/server-chat.ts
**Tags:** `refactor`, `testing`

Extracts server chat event test harness into shared test utilities.

---

## 00476 — refactor(test): share corrupt session fixture
**SHA:** e683353cab · **Date:** 2026-02-15 15:42
**Files changed:** src/test/sessions.ts
**Tags:** `refactor`, `testing`

Creates shared corrupt session test fixture used across multiple session-related test suites.

---

## 00477 — refactor(test): dedupe ghost reminder assertions
**SHA:** 2b143de554 · **Date:** 2026-02-15 15:40
**Files changed:** src/test/reminders.ts
**Tags:** `refactor`, `testing`

Consolidates duplicate ghost reminder assertion logic in test utilities.

---

## 00478 — refactor(test): simplify heartbeat model override tests
**SHA:** d979c6c089 · **Date:** 2026-02-15 15:36
**Files changed:** src/test/heartbeat.ts
**Tags:** `refactor`, `testing`

Simplifies heartbeat model override test patterns by using shared assertion helpers.

---

## 00479 — refactor(test): share heartbeat sandbox
**SHA:** ee331e8d55 · **Date:** 2026-02-15 15:35
**Files changed:** src/test/heartbeat-sandbox.ts
**Tags:** `refactor`, `testing`

Extracts heartbeat sandbox environment into shared test fixture used by multiple test suites.

---

## 00480 — fix(announce): use deterministic idempotency keys to prevent duplicate subagent announces (#17150)
**SHA:** ade11ec892 · **Date:** 2026-02-15 16:34
**Files changed:** src/announce/idempotency.ts
**Tags:** `bugfix`

Implements deterministic idempotency keys for subagent announcements to prevent duplicate message delivery when operations retry.

---

## 00481 — refactor(test): share status transcript log writer
**SHA:** 7ea14a1c87 · **Date:** 2026-02-15 15:32
**Files changed:** src/test/status-log.ts
**Tags:** `refactor`, `testing`

Extracts status transcript log writer into shared test utility for transcript-based test assertions.

---

## 00482 — fix: make sensitive field whitelist case-insensitive (#16148)
**SHA:** 1911942363 · **Date:** 2026-02-15 21:01
**Files changed:** src/security/sensitive.ts
**Tags:** `bugfix`

Fixes sensitive field whitelist matching to be case-insensitive, preventing false positives in field masking.

---

## 00483 — gateway: return actionable error for send channel webchat (#15703)
**SHA:** 6565ec2e53 · **Date:** 2026-02-15 12:31
**Files changed:** src/gateway/send.ts
**Tags:** `ux`

Improves error messaging when sending to webchat channels by providing actionable guidance instead of generic errors.

---

## 00484 — refactor(test): dedupe hook transform skip assertions
**SHA:** 3d38e56401 · **Date:** 2026-02-15 15:30
**Files changed:** src/test/hooks-transform.ts
**Tags:** `refactor`, `testing`

Consolidates duplicate hook transform skip assertion patterns in test utilities.

---

## 00485 — chore(memory): tighten embedding harness types
**SHA:** 2e64cbd1b8 · **Date:** 2026-02-15 10:24
**Files changed:** src/memory/embedding-manager.test-harness.ts
**Tags:** `type-safety`

Improves TypeScript strictness in embedding test harness by removing any types and adding proper type annotations.

---

## 00486 — chore(cron): simplify enabled checks for lint
**SHA:** 88caa4b50c · **Date:** 2026-02-15 10:19
**Files changed:** src/cron/config.ts
**Tags:** `linting`

Simplifies cron enabled status checks to improve code clarity and reduce complexity in configuration logic.

---

## 00487 — refactor(test): dedupe models list provider filter cases
**SHA:** fa4c282f9e · **Date:** 2026-02-15 15:29
**Files changed:** src/test/models-filter.ts
**Tags:** `refactor`, `testing`

Consolidates duplicate model provider filter test cases into shared test patterns.

---

## 00488 — refactor(test): dedupe update runner stable command mocks
**SHA:** 88cac5985e · **Date:** 2026-02-15 15:27
**Files changed:** src/test/update-runner.ts
**Tags:** `refactor`, `testing`

Removes duplicate update runner stable command mock setup from test utilities.

---

## 00489 — refactor(test): share line auto-reply deps
**SHA:** 0f4036b0f6 · **Date:** 2026-02-15 15:26
**Files changed:** src/test/line-auto-reply.ts
**Tags:** `refactor`, `testing`

Extracts LINE auto-reply test dependencies into shared fixture.

---

## 00490 — fix(subagents): add model fallback support to sessions_spawn tool (#17197)
**SHA:** c211fd112c · **Date:** 2026-02-15 20:55
**Files changed:** src/subagents/sessions-spawn.ts
**Tags:** `bugfix`

Adds model fallback mechanism to sessions_spawn tool so subagent spawning can continue with default model if primary is unavailable.

---

## 00491 — refactor(test): dedupe telegram bot mention scaffolding
**SHA:** 75f3b5069b · **Date:** 2026-02-15 15:24
**Files changed:** src/test/telegram-bot.ts
**Tags:** `refactor`, `testing`

Consolidates duplicate Telegram bot mention test scaffolding into shared fixtures.

---

## 00492 — refactor(test): dedupe model directive persist setup
**SHA:** 831fb0aea3 · **Date:** 2026-02-15 15:22
**Files changed:** src/test/model-directive.ts
**Tags:** `refactor`, `testing`

Removes duplicate model directive persistence test setup by consolidating into shared test utility.

---

## 00493 — refactor(test): dedupe monitor inbox quoted reply checks
**SHA:** 7ecc105c3d · **Date:** 2026-02-15 15:20
**Files changed:** src/test/monitor-inbox.ts
**Tags:** `refactor`, `testing`

Consolidates duplicate quoted reply assertion logic in monitor inbox test utilities.

---

## 00494 — refactor(test): dedupe telegram dispatch scaffolding
**SHA:** 4f8a2ed2ce · **Date:** 2026-02-15 15:19
**Files changed:** src/test/telegram-dispatch.ts
**Tags:** `refactor`, `testing`

Removes duplicate Telegram dispatch test scaffolding by consolidating setup patterns.

---

## 00495 — refactor(test): simplify onboarding wizard scaffolding
**SHA:** 53ffc309f3 · **Date:** 2026-02-15 15:16
**Files changed:** src/test/onboarding-wizard.ts
**Tags:** `refactor`, `testing`

Simplifies onboarding wizard test setup by sharing common scaffolding across test suites.

---

## 00496 — refactor(test): dedupe onboarding gateway prompter
**SHA:** 3e7800befb · **Date:** 2026-02-15 15:15
**Files changed:** src/test/onboarding-gateway.ts
**Tags:** `refactor`, `testing`

Consolidates duplicate onboarding gateway prompter test mocks into shared fixtures.

---

## 00497 — refactor(test): share signal receive harness
**SHA:** e2f73650d4 · **Date:** 2026-02-15 15:14
**Files changed:** src/test/signal-receive.ts
**Tags:** `refactor`, `testing`

Extracts signal receive test harness into shared utility used by multiple signal-related tests.

---

## 00498 — cron: infer payload kind for model-only update patches (#15664)
**SHA:** 89dccc79a7 · **Date:** 2026-02-15 12:12
**Files changed:** src/cron/payload-kind.ts
**Tags:** `core-feature`

Enhances cron update dispatch to infer payload kind automatically for model-only patches, reducing configuration complexity.

---

## 00499 — refactor(test): dedupe followup queue test setup
**SHA:** 3c97ec70d1 · **Date:** 2026-02-15 15:11
**Files changed:** src/test/followup-queue.ts
**Tags:** `refactor`, `testing`

Consolidates duplicate followup queue test setup by extracting shared initialization patterns.

---

## 00500 — refactor(test): dedupe session-memory hook setup
**SHA:** beffb6fe48 · **Date:** 2026-02-15 15:09
**Files changed:** src/test/session-memory.ts
**Tags:** `refactor`, `testing`

Removes duplicate session-memory hook initialization from test fixtures by creating shared test setup utility.

---
