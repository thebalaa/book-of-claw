# Commit Reference: 00051â€“00100

A plain factual summary of every commit in the OpenClaw repository, from commit 51 through commit 100.

---

## 00051 â€” Use lowercase warelay branding in README
**SHA:** 343ef9b63d Â· **Time:** 17:47
**Files changed:** README.md
**Tags:** `documentation`

Changed the main heading in the README from "ðŸ“¡ Warelay" to "ðŸ“¡ warelay" for consistent lowercase branding of the product name throughout the documentation.

---

## 00052 â€” Add coverage run with thresholds and align tests to utils
**SHA:** 5ee4f3219d Â· **Time:** 17:51
**Files changed:** package.json, src/index.test.ts
**Tags:** `testing`

Added test coverage configuration with thresholds (70% minimum for lines, functions, branches, statements) targeting the utils module, and added a new `test:coverage` npm script to run vitest with coverage reporting. Moved test imports to use the new `utils.js` module.

---

## 00053 â€” Add web provider inbound monitor with auto-replies
**SHA:** 9b4dceecfe Â· **Time:** 18:33
**Files changed:** README.md, src/index.ts
**Tags:** `provider`, `auto-reply`, `core-feature`

Introduced `web:monitor` command for the web provider to listen for inbound messages and execute auto-replies from configuration. Added support for session management with per-sender scoping, reset triggers (`/new`), idle expiration, and new template variables (`{{SessionId}}`, `{{IsNewSession}}`). Updated README with web provider auto-reply examples and configuration documentation.

---

## 00054 â€” Unify relay entrypoint and default to web when available
**SHA:** 73a3463ec8 Â· **Time:** 23:55
**Files changed:** README.md, src/index.ts
**Tags:** `refactor`, `core-feature`

Created a unified `relay` command that intelligently defaults to the web provider if the user is logged in, otherwise falls back to Twilio polling. Deprecated the individual `poll` and `web:monitor` commands in favor of `relay --provider [web|twilio]`. Updated documentation to reflect the new command naming and changed default web provider session storage from `~/.warelay/waweb/` to `~/.warelay/credentials.json`.

---

## 00055 â€” Fix lint warnings and tighten test mocks
**SHA:** 52e0c8de25 Â· **Time:** 00:10
**Files changed:** src/commands/up.ts, src/commands/relay.ts, src/index.test.ts, src/index.ts
**Tags:** `linting`, `testing`, `refactor`

Created new command modules (up.ts, relay.ts) to modularize command logic and resolved lint warnings. Tightened test mocks to ensure proper type safety and accurate test coverage for the relay and up command implementations.

---

## 00056 â€” Add command modules and tests; commit remaining changes
**SHA:** 938e237411 Â· **Time:** 00:12
**Files changed:** .github/workflows/ci.yml, coverage/*, src/commands/*, src/index.test.ts, src/index.ts
**Tags:** `testing`, `refactor`, `documentation`

Completed the modularization of CLI commands by extracting send, status, webhook, and login/web-login commands into separate modules. Added comprehensive test coverage infrastructure with coverage HTML reports. Updated CI workflow to respect PNPM script execution flags. Committed remaining generated coverage artifacts.

---

## 00057 â€” Fix provider-web mocks and make tests green
**SHA:** 9dd257a92d Â· **Time:** 00:16
**Files changed:** src/commands/relay.test.ts, src/provider-web.test.ts, src/provider-web.ts
**Tags:** `testing`, `provider`, `bugfix`

Fixed mocking issues in the web provider tests and relay command tests to properly stub Baileys session behavior. Corrected type mismatches and ensured all tests pass with accurate provider implementations.

---

## 00058 â€” Add login alias for web QR and update docs/tests
**SHA:** 9595964419 Â· **Time:** 00:19
**Files changed:** README.md, src/index.ts, src/index.test.ts
**Tags:** `documentation`, `ux`

Added a `login` alias for the `web:login` command to simplify the QR login workflow for the web provider. Updated README documentation to reference the new alias and updated relevant tests to verify the alias functionality.

---

## 00059 â€” Fix bailey auth import fallback and assert login alias
**SHA:** 3b8a31660b Â· **Time:** 00:22
**Files changed:** src/provider-web.ts, src/index.test.ts
**Tags:** `bugfix`, `provider`, `testing`

Fixed the Baileys auth import fallback logic to properly handle authentication credential loading. Added test assertions to verify the `login` alias works correctly with the web provider initialization.

---

## 00060 â€” Pin to @whiskeysockets/baileys 7.0.0-rc.9 and remove auth fallback
**SHA:** 289b417c8e Â· **Time:** 00:28
**Files changed:** package.json, src/provider-web.ts
**Tags:** `dependency`, `refactor`, `provider`

Pinned the Baileys dependency to version 7.0.0-rc.9 (the official @whiskeysockets fork) and removed the deprecated auth fallback code now that the latest version handles authentication properly.

---

## 00061 â€” Update to latest Baileys RC and clean imports
**SHA:** 66359736d3 Â· **Time:** 00:29
**Files changed:** src/provider-web.ts, src/index.ts
**Tags:** `dependency`, `refactor`

Updated to the latest Baileys RC release and cleaned up import statements throughout the codebase for consistency and maintainability. Removed unnecessary import aliases and reorganized module imports.

---

## 00062 â€” Switch to Baileys multi-file auth with latest rc
**SHA:** e12e6989c0 Â· **Time:** 00:34
**Files changed:** src/provider-web.ts
**Tags:** `provider`, `refactor`

Migrated authentication storage from single-file to multi-file format as required by the latest Baileys RC. Updated credential loading and persistence logic to use the new file structure for better session management.

---

## 00063 â€” Fix web auth detection and auto-restart after 515
**SHA:** 7a5f5b8efe Â· **Time:** 00:49
**Files changed:** src/provider-web.ts
**Tags:** `bugfix`, `provider`

Fixed web authentication detection logic and added automatic restart capability when the Baileys session encounters a 515 (logout) error. Improves reliability of the web provider during long-running relay sessions.

---

## 00064 â€” Add lint:fix to run biome check+format
**SHA:** b76ed7e2bb Â· **Time:** 00:50
**Files changed:** package.json
**Tags:** `linting`

Added a new `lint:fix` npm script that runs Biome in check+format mode to automatically fix linting and formatting issues in a single command, improving developer workflow.

---

## 00065 â€” Show provider numbers in relay banner
**SHA:** d501ac7acb Â· **Time:** 01:35
**Files changed:** src/commands/relay.ts
**Tags:** `ux`, `verbosity`

Enhanced the relay command's startup banner to display the phone number or identifier for each active provider, making it clearer which phone number is being monitored for auto-replies.

---

## 00066 â€” Add claudeOutputFormat support and provider banners
**SHA:** b4e5f20cd7 Â· **Time:** 01:36
**Files changed:** src/index.ts, src/provider-web.ts, README.md
**Tags:** `documentation`, `auto-reply`, `core-feature`

Added support for the `claudeOutputFormat` configuration option to allow different Claude CLI output formats (json, text). Enhanced provider banners to show clearer status information. Updated documentation to explain Claude output handling.

---

## 00067 â€” Ignore coverage output and document Claude text mode
**SHA:** d0c9bff4ca Â· **Time:** 01:38
**Files changed:** .gitignore, README.md
**Tags:** `documentation`

Added coverage output directory to .gitignore and documented how to use Claude in text (non-JSON) output mode for auto-replies, providing guidance for different Claude CLI configurations.

---

## 00068 â€” Silence Baileys session logs unless verbose
**SHA:** 134edc5e49 Â· **Time:** 01:40
**Files changed:** src/provider-web.ts
**Tags:** `verbosity`, `provider`

Suppressed verbose Baileys session logs by default to reduce noise in normal operation. Logs only appear when the verbose flag is enabled, improving the user experience for quiet mode operation.

---

## 00069 â€” Parse Claude JSON output to return text replies
**SHA:** ba3b271c39 Â· **Time:** 01:41
**Files changed:** src/auto-reply/claude.ts, src/auto-reply/claude.test.ts
**Tags:** `auto-reply`, `refactor`

Implemented robust parsing of Claude JSON output format to extract text replies from various JSON structures. Added helper functions and tests to handle Claude's different output formats and ensure reliable text extraction for auto-replies.

---

## 00070 â€” Extract auto-reply helpers into modules
**SHA:** b8b0873c1e Â· **Time:** 02:16
**Files changed:** src/auto-reply/claude.ts, src/auto-reply/command.ts, src/auto-reply/session.ts
**Tags:** `refactor`

Modularized auto-reply logic by extracting Claude-specific, command execution, and session management helpers into separate files. Improved code organization and testability by isolating concerns.

---

## 00071 â€” Extract env + Twilio utils; shrink index
**SHA:** c71abf13a1 Â· **Time:** 02:20
**Files changed:** src/utils/env.ts, src/utils/twilio.ts, src/index.ts
**Tags:** `refactor`

Extracted environment variable handling and Twilio API utilities into dedicated modules, significantly reducing the size of index.ts. Created a cleaner modular structure for environment and provider-specific operations.

---

## 00072 â€” Refactor CLI and Twilio modules; add helper tests and comments
**SHA:** afdaa7ef98 Â· **Time:** 03:11
**Files changed:** src/commands/cli-helpers.ts, src/utils/twilio.ts, src/utils/twilio.test.ts
**Tags:** `refactor`, `testing`, `documentation`

Refactored CLI helper functions into a dedicated module and reorganized Twilio utilities. Added comprehensive unit tests and inline comments for helper functions to improve code maintainability and documentation.

---

## 00073 â€” refactor: extract twilio message utilities
**SHA:** 39b3fffe3b Â· **Time:** 03:22
**Files changed:** src/utils/twilio-messages.ts, src/index.ts
**Tags:** `refactor`

Extracted Twilio message-specific operations (retrieval, filtering, formatting) into a dedicated utilities module, further modularizing message handling logic and reducing main index complexity.

---

## 00074 â€” docs: clarify claude output handling
**SHA:** cac2debc34 Â· **Time:** 03:23
**Files changed:** README.md
**Tags:** `documentation`

Clarified the README section on Claude output handling, explaining the difference between JSON and text modes and how to configure each mode appropriately for auto-replies.

---

## 00075 â€” docs: broaden README for web provider
**SHA:** 5c5a103abb Â· **Time:** 03:24
**Files changed:** README.md
**Tags:** `documentation`

Expanded README documentation to provide more comprehensive guidance on using the web provider, including setup, advantages, and limitations compared to the Twilio provider.

---

## 00076 â€” refactor: modularize cli helpers
**SHA:** a89d7319a9 Â· **Time:** 03:42
**Files changed:** src/commands/cli-helpers.ts
**Tags:** `refactor`

Further modularized CLI helper utilities by extracting common CLI patterns into a dedicated helpers module, improving code reusability and maintainability.

---

## 00077 â€” feat: add config validation and send dry-run
**SHA:** 8bd406f6b1 Â· **Time:** 03:46
**Files changed:** src/commands/send.ts, src/utils/config.ts
**Tags:** `core-feature`, `ux`

Added configuration validation to check that required fields are present and properly formatted before attempting to send. Implemented `--dry-run` flag for the send command to preview the message payload without actually sending.

---

## 00078 â€” feat: add logger and twilio poll backoff
**SHA:** 7fa071267c Â· **Time:** 03:48
**Files changed:** src/utils/logger.ts, src/commands/relay.ts
**Tags:** `core-feature`, `refactor`

Created a centralized logger module to consolidate logging operations across the codebase. Added exponential backoff logic to Twilio polling to reduce API pressure and improve reliability during polling operations.

---

## 00079 â€” test: add infra coverage and fix web logging
**SHA:** 594fb125e6 Â· **Time:** 03:50
**Files changed:** src/commands/relay.test.ts, src/provider-web.ts
**Tags:** `testing`, `provider`, `verbosity`

Expanded test coverage for relay command infrastructure and fixed web provider logging to properly route messages through the centralized logger. Improved logging consistency across providers.

---

## 00080 â€” chore: harden claude json parsing and logging
**SHA:** d2abe3c459 Â· **Time:** 03:50
**Files changed:** src/auto-reply/claude.ts, src/auto-reply/claude.test.ts
**Tags:** `refactor`, `testing`

Strengthened Claude JSON parsing logic with additional error handling and edge case coverage. Enhanced logging for Claude invocation to provide better debugging information when JSON parsing fails.

---

## 00081 â€” chore: route port error debug through logger
**SHA:** 1f5390ed99 Â· **Time:** 03:51
**Files changed:** src/commands/webhook.ts
**Tags:** `refactor`, `verbosity`

Routed port availability check errors and debug information through the centralized logger instead of direct console output, ensuring consistent logging behavior across all commands.

---

## 00082 â€” docs: note dry-run and config validation
**SHA:** b3511e1192 Â· **Time:** 03:52
**Files changed:** README.md
**Tags:** `documentation`

Added documentation explaining the new config validation and `--dry-run` features, helping users understand how to validate configurations and preview messages before sending.

---

## 00083 â€” refactor: add provider barrels and webhook grouping
**SHA:** af577f07da Â· **Time:** 03:56
**Files changed:** src/providers/index.ts, src/webhooks/index.ts
**Tags:** `refactor`

Created barrel (index) files for provider and webhook modules to improve import organization and create cleaner public APIs for the provider and webhook subsystems.

---

## 00084 â€” feat: add dry-run options and retry helper
**SHA:** fdfb1df0de Â· **Time:** 03:57
**Files changed:** src/commands/send.ts, src/utils/retry.ts
**Tags:** `core-feature`, `refactor`

Extended dry-run support to all relevant commands and created a reusable retry helper utility with configurable backoff strategy. Enables robust handling of transient failures across the codebase.

---

## 00085 â€” chore: logger cleanup and test fixes
**SHA:** d7cc94333a Â· **Time:** 04:05
**Files changed:** src/utils/logger.ts, src/commands/*.test.ts
**Tags:** `refactor`, `testing`

Cleaned up logger implementation to improve consistency and fixed related test failures. Ensured all command tests properly mock the logger to maintain test isolation.

---

## 00086 â€” feat: add send --json, logger cleanup, and resilient Claude parsing
**SHA:** d1923e6efe Â· **Time:** 04:08
**Files changed:** src/commands/send.ts, src/auto-reply/claude.ts, src/auto-reply/claude.test.ts
**Tags:** `core-feature`, `auto-reply`, `refactor`

Added `--json` flag to the send command to output results in machine-readable JSON format. Implemented resilient Claude JSON parsing with validation schemas and added tests covering various Claude output formats and error cases.

---

## 00087 â€” feat: retries for webhook bring-up and send --json docs
**SHA:** 28277a298a Â· **Time:** 04:10
**Files changed:** src/commands/webhook.ts, README.md
**Tags:** `core-feature`, `documentation`

Added retry logic to the webhook startup process to handle transient failures during port binding and server initialization. Updated README to document the new `send --json` feature and its use cases.

---

## 00088 â€” chore: route exec logging through logger
**SHA:** 39cd9bde1f Â· **Time:** 04:11
**Files changed:** src/utils/exec.ts, src/auto-reply/command.ts
**Tags:** `refactor`, `verbosity`

Refactored all command execution logging to use the centralized logger, ensuring consistent formatting and log level handling for spawned subprocess output.

---

## 00089 â€” chore: align web provider logging and relay e2e
**SHA:** ca0b50d772 Â· **Time:** 04:15
**Files changed:** src/provider-web.ts, src/commands/relay.test.ts
**Tags:** `refactor`, `testing`, `verbosity`

Aligned web provider logging with the centralized logger and updated relay command end-to-end tests to validate proper logging output across both Twilio and web providers.

---

## 00090 â€” chore: finish logger sweep and add retry tests
**SHA:** ec630839a9 Â· **Time:** 04:30
**Files changed:** src/**/*.ts, src/utils/retry.test.ts
**Tags:** `refactor`, `testing`, `verbosity`

Completed the migration of all remaining console.log/error calls to the centralized logger throughout the codebase. Added comprehensive test coverage for the retry helper utility with various failure scenarios.

---

## 00091 â€” chore: remove refactor plan doc
**SHA:** 6dd0d04206 Â· **Time:** 04:35
**Files changed:** docs/refactor-plan.md
**Tags:** `documentation`

Removed the refactor plan document after completing the major modularization and logging consolidation effort.

---

## 00092 â€” feat: serialize command auto-replies with queue
**SHA:** 13be898c07 Â· **Time:** 04:40
**Files changed:** src/auto-reply/queue.ts, src/commands/relay.ts
**Tags:** `core-feature`, `process-lifecycle`

Implemented a queue mechanism for command-based auto-replies to serialize execution and prevent concurrent command invocations from interfering with each other. Ensures replies execute sequentially while maintaining responsiveness.

---

## 00093 â€” chore: fix type regressions and helpers
**SHA:** 2aac606979 Â· **Time:** 04:40
**Files changed:** src/**/*.ts
**Tags:** `type-safety`, `refactor`

Fixed TypeScript type regressions introduced during refactoring and improved type annotations for helper utilities. Ensured full type safety across all modules after modularization.

---

## 00094 â€” feat: log auto-reply body and stats for web provider
**SHA:** 3aedef4126 Â· **Time:** 04:42
**Files changed:** src/provider-web.ts, src/commands/relay.ts
**Tags:** `verbosity`, `auto-reply`

Enhanced logging for web provider auto-replies to show the reply body and execution statistics (duration, bytes sent). Improved visibility into auto-reply behavior during relay operations.

---

## 00095 â€” chore: add color to web auto-reply log
**SHA:** daf45190a9 Â· **Time:** 04:42
**Files changed:** src/provider-web.ts
**Tags:** `verbosity`, `ux`

Added colored output (via chalk) to web provider auto-reply logs to improve readability and visual distinction between different event types in terminal output.

---

## 00096 â€” docs: expand README with Claude setup and FAQ
**SHA:** 14b3c6fba5 Â· **Time:** 04:44
**Files changed:** README.md
**Tags:** `documentation`

Significantly expanded the README with detailed Claude CLI setup instructions and a FAQ section addressing common usage patterns, troubleshooting, and configuration questions.

---

## 00097 â€” docs: fix markdown escaping in README
**SHA:** 435ca06f16 Â· **Time:** 04:45
**Files changed:** README.md
**Tags:** `documentation`

Fixed markdown syntax issues and escaping problems in the README, ensuring proper rendering of special characters and code examples in documentation.

---

## 00098 â€” docs: add guidance to use dedicated WhatsApp account
**SHA:** df79c59c8e Â· **Time:** 04:46
**Files changed:** README.md
**Tags:** `documentation`

Added prominent guidance in the README recommending users create a dedicated WhatsApp account for automation to avoid rate-limiting or account suspension risks associated with personal account automation.

---

## 00099 â€” ci: run vitest in workflow
**SHA:** ac2bdcbea6 Â· **Time:** 04:48
**Files changed:** .github/workflows/ci.yml
**Tags:** `testing`

Integrated vitest test execution into the GitHub Actions CI workflow to automatically run tests on every push and pull request, ensuring code quality and test coverage requirements are met.

---

## 00100 â€” feat: add image support across web and twilio
**SHA:** 948ff7f035 Â· **Time:** 04:58
**Files changed:** docs/images.md, src/commands/send.ts, src/provider-web.ts, src/utils/twilio.ts, src/auto-reply/media.ts
**Tags:** `core-feature`

Implemented comprehensive image support across both web and Twilio providers. Added `--media` flag to send command, media hosting on webhook server using Tailscale Funnel, and auto-reply media configuration. Includes detailed specification document outlining image handling for both providers with size limits, TTL expiration, and hosting strategies.

---
