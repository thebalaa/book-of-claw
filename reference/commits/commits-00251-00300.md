# Commit Reference: 00251â€“00300

A plain factual summary of every commit in the OpenClaw repository, from commit 251 through commit 300.

---

## 00251 â€” Fix CI: type gaps and hasMedia check
**SHA:** d4580d1a31 Â· **Date:** 2025-11-27 18:14
**Files changed:** `src/config/config.ts`, `src/web/auto-reply.ts`
**Tags:** `type-safety`, `bugfix`

Adds `heartbeatMinutes` config option to the WarelayConfig type for command mode heartbeat cadence. Fixes type-safe media detection by replacing loose truthy check with explicit Boolean coercion on mediaUrl/mediaUrls, preventing edge cases with falsy values.

---

## 00252 â€” Update README.md
**SHA:** 537348d995 Â· **Date:** 2025-11-27 18:14
**Files changed:** `README.md`
**Tags:** `documentation`, `ux`

Adds personal introduction mentioning Clawd as a pro-active assistant example and links to the Twitter account (@steipete). Signals the project's early stage and actively demonstrates real-world usage.

---

## 00253 â€” Docs: link Clawd setup and current config
**SHA:** 549ad272fc Â· **Date:** 2025-11-27 18:17
**Files changed:** `README.md`, `docs/claude-config.md`
**Tags:** `documentation`, `ux`

Integrates Twitter link and Clawd reference directly into the main README summary. Expands claude-config.md with "Current personal config" section showing live ~/.warelay/warelay.json with Clawd setup, session persistence, and heartbeat documentation.

---

## 00254 â€” Fix WebSocket crash + heartbeat default 10min + docs refresh
**SHA:** 85f53a4174 Â· **Date:** 2025-11-27 18:21
**Files changed:** `CHANGELOG.md`, `README.md`, `docs/claude-config.md`, `src/index.ts`, `src/web/auto-reply.ts`, `src/web/inbound.ts`, `src/web/session.ts`
**Tags:** `bugfix`, `process-lifecycle`, `documentation`, `refactor`

Wraps Baileys connection.update listeners in try-catch and adds global unhandledRejection/uncaughtException handlers to prevent silent crashes from unhandled errors. Changes default heartbeat from 30m to 10m. Comprehensively rewrites claude-config.md as narrative guide with Clawd personality section, MCPs table, and heartbeat capabilities.

---

## 00255 â€” Add warning disclaimer to claude-config.md
**SHA:** f0a5cdc6e4 Â· **Date:** 2025-11-27 18:23
**Files changed:** `docs/claude-config.md`
**Tags:** `documentation`

Adds disclaimer warning section at the top of claude-config.md regarding usage of `--dangerously-skip-permissions` flag and potential system risks.

---

## 00256 â€” Redact phone number from example config
**SHA:** 5bc151fdca Â· **Date:** 2025-11-27 18:24
**Files changed:** `docs/claude-config.md`
**Tags:** `documentation`

Replaces phone number in example config with `***REMOVED***` placeholder for privacy and security best practices in public documentation.

---

## 00257 â€” Add Peekaboo and mcporter links to recommended tools
**SHA:** e88ff78816 Â· **Date:** 2025-11-27 18:26
**Files changed:** `docs/claude-config.md`
**Tags:** `documentation`, `ux`

Extends MCP recommendations with Peekaboo (for web interaction) and mcporter (for multi-client MCP config management) links in the recommended MCPs section.

---

## 00258 â€” Fix: warelay lowercase
**SHA:** e2ccde6434 Â· **Date:** 2025-11-27 18:27
**Files changed:** `docs/claude-config.md`
**Tags:** `documentation`, `naming`

Normalizes capitalization of "warelay" throughout documentation from inconsistent casing to lowercase to match brand convention.

---

## 00259 â€” Docs: mention Claude Code reuses existing subscription
**SHA:** a888564251 Â· **Date:** 2025-11-27 18:28
**Files changed:** `docs/claude-config.md`
**Tags:** `documentation`, `ux`

Adds note clarifying that Claude Code reuses existing Anthropic subscription (no separate charge), addressing user confusion about pricing and access.

---

## 00260 â€” Docs: explain two-phone setup for dedicated AI number
**SHA:** e1bd9976b3 Â· **Date:** 2025-11-27 18:29
**Files changed:** `docs/claude-config.md`
**Tags:** `documentation`, `ux`

Documents recommended practice of using dedicated second phone for AI assistant with its own WhatsApp number, improving privacy separation and interaction clarity.

---

## 00261 â€” Docs: new Clawd session intro with personality and powers
**SHA:** c43cdc5ac3 Â· **Date:** 2025-11-27 18:32
**Files changed:** `docs/claude-config.md`
**Tags:** `documentation`, `ux`

Rewrites sessionIntro section with more personality and clearer description of Clawd's capabilities, workspace access, and response constraints for WhatsApp platform.

---

## 00262 â€” Docs: add useful CLI tools section (spotify-player, TTS, etc.)
**SHA:** 49ada54f6d Â· **Date:** 2025-11-27 18:33
**Files changed:** `docs/claude-config.md`
**Tags:** `documentation`, `ux`

Introduces new "Useful CLI Tools" section documenting helpers like spotify-player, TTS engines, and browser tools that complement Claude's command execution in personal assistant context.

---

## 00263 â€” Heartbeat defaults and ws guard; format
**SHA:** 9b3c4db10d Â· **Date:** 2025-11-27 18:37
**Files changed:** `src/web/auto-reply.ts`, `src/web/inbound.ts`
**Tags:** `refactor`, `documentation`

Code formatting and WebSocket error handling refinements. Ensures heartbeat and WebSocket operations follow consistent patterns across the codebase.

---

## 00264 â€” Add WhatsApp screenshot to claude-config.md
**SHA:** 7377c676fd Â· **Date:** 2025-11-27 18:43
**Files changed:** `docs/claude-config.md`
**Tags:** `documentation`, `ux`

Embeds WhatsApp screenshot demonstrating Clawd in action in the "Meet Clawd" section, providing visual proof of concept for users.

---

## 00265 â€” Add gowa WhatsApp MCP to power user add-ons
**SHA:** 8acd82aa0d Â· **Date:** 2025-11-27 18:45
**Files changed:** `docs/claude-config.md`
**Tags:** `documentation`, `ux`

Extends power user MCPs recommendations with gowa (WhatsApp automation MCP) for users building advanced integrations.

---

## 00266 â€” Docs: refresh 1.2.0 changelog; fix webhook host import
**SHA:** 0cc732dce3 Â· **Date:** 2025-11-27 18:46
**Files changed:** `CHANGELOG.md`, `src/commands/webhook.ts`
**Tags:** `documentation`, `dependency`

Updates CHANGELOG for 1.2.0 release and fixes webhook host import path, ensuring build consistency and accurate version notes.

---

## 00267 â€” Release 1.2.0
**SHA:** 6d7e620430 Â· **Date:** 2025-11-27 18:52
**Files changed:** `package.json`, `package-lock.json`
**Tags:** `core-feature`, `verbosity`

Version bump to 1.2.0 marking major feature release including WebSocket crash fixes, heartbeat defaults, and comprehensive documentation overhaul.

---

## 00268 â€” Add browser-tools CLI and example tweets to docs
**SHA:** f5d7057042 Â· **Date:** 2025-11-27 18:59
**Files changed:** `docs/clawd.md`
**Tags:** `documentation`, `ux`

Documents browser-tools as lightweight DevTools alternative and adds "See It In Action" section with three example tweets showing Clawd autonomously replying via Twitter integration.

---

## 00269 â€” Rename claude-config.md to clawd.md, update credits
**SHA:** 8912b3e035 Â· **Date:** 2025-11-27 19:07
**Files changed:** `docs/claude-config.md` â†’ `docs/clawd.md`, `README.md`, `CREDITS.md`
**Tags:** `naming`, `documentation`, `refactor`

Renames documentation file from claude-config.md to clawd.md to better reflect personal assistant branding. Updates all references and adds Clawd as co-author in credits (they/them pronouns).

---

## 00270 â€” Expand heartbeat capabilities in docs
**SHA:** 8d4b31a301 Â· **Date:** 2025-11-27 19:09
**Files changed:** `docs/clawd.md`
**Tags:** `documentation`, `ux`

Extends heartbeat documentation with more examples and use cases for proactive monitoring scenarios, helping users understand autonomous assistant capabilities.

---

## 00271 â€” docs: Add Twitter automation and music recognition examples
**SHA:** 8ebe72951f Â· **Date:** 2025-11-27 21:00
**Files changed:** `docs/clawd.md`
**Tags:** `documentation`, `ux`

Documents Twitter automation patterns using Peekaboo + AppleScript, JavaScript injection for UI reliability, and audd.io music recognition API showing real Clawd techniques.

---

## 00272 â€” Fix broken link: claude-config.md -> clawd.md
**SHA:** f871869c79 Â· **Date:** 2025-11-28 05:19
**Files changed:** `README.md`
**Tags:** `bugfix`, `documentation`

Corrects broken internal link reference from old filename claude-config.md to renamed clawd.md throughout documentation.

---

## 00273 â€” fix(media): sniff mime and keep extensions
**SHA:** 7d6a4f5204 Â· **Date:** 2025-11-28 08:07
**Files changed:** `src/media/mime.ts` (new), `src/media/download.ts`, `src/media/handler.ts`
**Tags:** `bugfix`, `refactor`

Introduces new mime.ts module with comprehensive MIME type sniffing and extension mapping. Refactors media handling to preserve original file extensions based on detected MIME types instead of relying on Content-Type headers alone.

---

## 00274 â€” docs: document mime-first media handling
**SHA:** f63bdda628 Â· **Date:** 2025-11-28 08:07
**Files changed:** `docs/clawd.md`
**Tags:** `documentation`

Explains updated media handling strategy prioritizing MIME type detection over headers, improving file extension accuracy for received media.

---

## 00275 â€” chore: release 1.2.1
**SHA:** c11abc1134 Â· **Date:** 2025-11-28 08:11
**Files changed:** `package.json`, `package-lock.json`
**Tags:** `bugfix`

Version bump to 1.2.1 patch release for media handling fixes and documentation updates.

---

## 00276 â€” docs: note changelog not needed for pure tests
**SHA:** 84f25953 Â· **Date:** 2025-11-28 08:13
**Files changed:** `docs/CONTRIBUTING.md` (or similar)
**Tags:** `documentation`, `testing`

Clarifies that pure test commits don't require CHANGELOG updates, simplifying contribution guidelines for test-focused changes.

---

## 00277 â€” feat(heartbeat): allow manual message and dry-run for web/twilio
**SHA:** 12d7be7cad Â· **Date:** 2025-11-28 08:14
**Files changed:** `src/commands/heartbeat.ts`, `CHANGELOG.md`
**Tags:** `core-feature`, `ux`

Adds manual message capability to heartbeat command and dry-run mode for both web and Twilio providers, enabling safer testing of heartbeat behavior before production use.

---

## 00278 â€” chore: move heartbeat notes to unreleased 1.2.2
**SHA:** 4e3663b4d4 Â· **Date:** 2025-11-28 08:14
**Files changed:** `CHANGELOG.md`
**Tags:** `documentation`

Reorganizes CHANGELOG moving heartbeat feature notes to 1.2.2 unreleased section in preparation for next patch release.

---

## 00279 â€” chore: release 1.2.2
**SHA:** 5bafe9483d Â· **Date:** 2025-11-28 08:17
**Files changed:** `package.json`, `package-lock.json`
**Tags:** `core-feature`

Version bump to 1.2.2 marking release of manual heartbeat and dry-run capabilities.

---

## 00280 â€” feat: same-phone mode with echo detection and configurable marker
**SHA:** d88ede92b9 Â· **Date:** 2025-11-29 04:50
**Files changed:** `src/web/inbound.ts`, `src/web/auto-reply.ts`, `src/config/config.ts`, tests
**Tags:** `core-feature`, `type-safety`, `ux`

Implements full same-phone mode supporting self-messaging setups where one person chats with an AI in the same WhatsApp bubble. Features echo detection via bounded Set (max 100) to prevent loops, configurable samePhoneMarker prefix (default "[same-phone]"), bypasses allowFrom check, and removes fromMe filter in favor of in-reply detection.

---

## 00281 â€” Add samePhoneResponsePrefix config option
**SHA:** 25ec1335 Â· **Date:** 2025-11-29 05:24
**Files changed:** `src/config/config.ts`, `src/web/auto-reply.ts`
**Tags:** `core-feature`, `ux`

Adds configurable responsePrefix applied only in same-phone mode, allowing visual distinction of bot replies (e.g., "ðŸ¦ž") within shared chat bubbles.

---

## 00282 â€” Add timestampPrefix config for datetime awareness
**SHA:** 26e02a9b8b Â· **Date:** 2025-11-29 05:25
**Files changed:** `src/config/config.ts`, `src/web/auto-reply.ts`
**Tags:** `core-feature`, `ux`

Introduces timestampPrefix (boolean) and timestampTimezone (IANA string) config options in compact format (e.g., "[Nov 29 06:30]") prepended to messages, helping AI stay aware of current date/time.

---

## 00283 â€” Generalize prefix config: messagePrefix + responsePrefix
**SHA:** 7564c4e7f4 Â· **Date:** 2025-11-29 05:27
**Files changed:** `src/config/config.ts`, `src/web/auto-reply.ts`, `README.md`
**Tags:** `refactor`, `ux`

Consolidates prefix configuration replacing samePhoneMarker/samePhoneResponsePrefix with unified messagePrefix (inbound, default "[warelay]" if no allowFrom) and responsePrefix (outbound). Maintains timestamp options under same pattern.

---

## 00284 â€” Simplify timestampPrefix: bool or timezone string, default true
**SHA:** 8d20edb028 Â· **Date:** 2025-11-29 05:29
**Files changed:** `src/config/config.ts`, `src/web/auto-reply.ts`
**Tags:** `refactor`, `ux`

Simplifies timestamp configuration to single timestampPrefix option accepting boolean (true=UTC, false=off) or IANA timezone string, removing separate timestampTimezone option and defaulting to enabled.

---

## 00285 â€” Skip responsePrefix for HEARTBEAT_OK responses
**SHA:** 37d8e5599 Â· **Date:** 2025-11-29 06:02
**Files changed:** `src/web/auto-reply.ts`
**Tags:** `bugfix`, `auto-reply`

Prevents responsePrefix from being applied to HEARTBEAT_OK responses, preserving exact match string for warelay heartbeat detection logic.

---

## 00286 â€” Add auto-recovery from stuck WhatsApp sessions
**SHA:** 69319a0569 Â· **Date:** 2025-11-30 17:53
**Files changed:** `src/web/inbound.ts`, `src/web/auto-reply.ts`, `CHANGELOG.md`
**Tags:** `bugfix`, `process-lifecycle`

Implements message timeout watchdog (10 min) auto-restarting connection if no messages received, early allowFrom filtering blocking unauthorized senders before encryption, and health monitoring in heartbeat warning if >30 min without messages. Fixes Bad MAC errors silently killing event emitter.

---

## 00287 â€” Fix test isolation to prevent loading real user config
**SHA:** 21ba0fb8a4 Â· **Date:** 2025-11-30 18:00
**Files changed:** `src/index.core.test.ts`, `src/web/inbound.media.test.ts`, `src/web/monitor-inbox.test.ts`, `src/test-helpers.ts`
**Tags:** `testing`, `bugfix`

Mocks loadConfig() in all test files to prevent loading user ~/.warelay/warelay.json with custom emojis/prefixes breaking assertions. Updates default mock config with clean settings (no prefixes, allowFrom=["*"]).

---

## 00288 â€” Increase watchdog timeout to 30 minutes
**SHA:** c5677df56e Â· **Date:** 2025-11-30 18:03
**Files changed:** `src/web/auto-reply.ts`
**Tags:** `refactor`, `process-lifecycle`

Changes message watchdog timeout from 10 to 30 minutes to avoid false positives when heartbeatMinutes=10, providing 3x buffer before auto-restart considering network latency and command delays.

---

## 00289 â€” Fix empty result JSON dump and missing heartbeat prefix
**SHA:** c5ab442f46 Â· **Date:** 2025-12-02 04:29
**Files changed:** `src/commands/command-reply.ts`, `src/web/auto-reply.ts`
**Tags:** `bugfix`, `auto-reply`

Fixes empty result field handling using explicit type check (`typeof parsed?.text === "string"`) preventing raw JSON when Claude CLI returns `result: ""`. Applies responsePrefix to heartbeat alert messages in runReplyHeartbeat.

---

## 00290 â€” Fix test corrupting production sessions.json
**SHA:** d107b79c63 Â· **Date:** 2025-12-02 05:54
**Files changed:** `src/commands/heartbeat.ts` (test)
**Tags:** `testing`, `bugfix`

Fixes test 'falls back to most recent session when no to is provided' using resolveStorePath() returning real ~/.warelay/sessions.json, overwriting production data. Switches to temp directory like other tests.

---

## 00291 â€” Update changelog with error message and test isolation fixes
**SHA:** 1b0e1edb08 Â· **Date:** 2025-12-02 05:59
**Files changed:** `CHANGELOG.md`
**Tags:** `documentation`

Updates CHANGELOG documenting empty result JSON handling fix, response prefix on heartbeat, and test session isolation improvements for upcoming release notes.

---

## 00292 â€” web: isolate session fixtures and skip heartbeat when busy
**SHA:** 2fc3a822c8 Â· **Date:** 2025-12-02 06:15
**Files changed:** `src/web/auto-reply.ts`, `src/web/inbound.ts`, tests
**Tags:** `testing`, `refactor`

Isolates session fixtures in tests preventing cross-test pollution. Adds logic to skip heartbeat when relay is actively processing messages, reducing unnecessary traffic during busy periods.

---

## 00293 â€” Add IPC to prevent Signal session corruption from concurrent connections
**SHA:** e86b507da7 Â· **Date:** 2025-12-02 06:31
**Files changed:** `src/web/ipc.ts` (new), `src/web/inbound.ts`, `src/commands/send.ts`, `src/commands/heartbeat.ts`, `CHANGELOG.md`
**Tags:** `bugfix`, `process-lifecycle`, `refactor`

Implements Unix socket IPC (~/.warelay/relay.sock) allowing `warelay send` and `warelay heartbeat` to reuse relay's existing connection instead of creating new Baileys sockets that corrupt Signal session ratchet. Relay starts IPC server, commands try IPC first with fallback, messages added to echo detection.

---

## 00294 â€” Document exclamation mark escaping workaround for Claude Code
**SHA:** e881b3c5de Â· **Date:** 2025-12-02 06:52
**Files changed:** `CLAUDE.md` (symlink), `AGENTS.md`
**Tags:** `documentation`, `ux`

Creates symlink CLAUDE.md â†’ AGENTS.md for Claude Code compatibility, documenting workaround for special character handling in agent configuration files.

---

## 00295 â€” Add typing indicator after IPC send
**SHA:** 96152f6577 Â· **Date:** 2025-12-02 06:58
**Files changed:** `src/commands/send.ts`
**Tags:** `ux`, `refactor`

Shows "composing" typing indicator after IPC message send so user knows more messages may be coming from running relay session.

---

## 00296 â€” feat(web): batch inbound messages
**SHA:** 5b54d4de7a Â· **Date:** 2025-12-02 07:54
**Files changed:** `src/web/inbound.ts`, `src/web/auto-reply.ts`
**Tags:** `core-feature`, `optimization`

Implements message batching for web provider, grouping multiple inbound messages and processing together to improve throughput and reduce processing overhead during high message volume.

---

## 00297 â€” chore: bump version to 1.3.0
**SHA:** 52c311e47f Â· **Date:** 2025-12-02 07:54
**Files changed:** `package.json`, `package-lock.json`
**Tags:** `core-feature`

Version bump to 1.3.0 marking major release with IPC, message batching, and multi-agent foundation.

---

## 00298 â€” Agents: add pluggable CLIs
**SHA:** f31e89d5af Â· **Date:** 2025-12-02 10:42
**Files changed:** `docs/agent.md` (new), `src/agents/*` (new module), `src/config/config.ts`, `src/commands/command-reply.ts`
**Tags:** `core-feature`, `refactor`

Introduces pluggable agent abstraction layer supporting multiple CLIs (Claude, Codex, Pi, Opencode) cleanly. New `src/agents/` module with per-agent argv builders and output parsers. Normalizes config with new `agent` block replacing legacy `claudeOutputFormat` knob. Preserves MEDIA handling and queue behavior.

---

## 00299 â€” Tests: cover agents and fix web defaults
**SHA:** ed080ae988 Â· **Date:** 2025-12-02 10:56
**Files changed:** `src/agents/*.test.ts` (new), `src/web/auto-reply.ts`, test fixtures
**Tags:** `testing`, `refactor`

Adds comprehensive test coverage for agent abstraction layer. Fixes web provider defaults ensuring consistency across Twilio and web modes for agent selection and output parsing.

---

## 00300 â€” Changelog: note multi-agent and batching
**SHA:** 2b941ccc93 Â· **Date:** 2025-12-02 10:58
**Files changed:** `CHANGELOG.md`
**Tags:** `documentation`, `core-feature`

Documents 1.3.0 release notes highlighting multi-agent support via pluggable CLI abstraction and web provider message batching optimization, marking significant architectural evolution.

---

