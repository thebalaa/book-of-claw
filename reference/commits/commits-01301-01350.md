# Commit Reference: 01301–01350

A plain factual summary of every commit in the OpenClaw repository, from commit 1301 through commit 1350.

---

## 01301 — chore(deps): update JS deps
**SHA:** 281c6d6069 · **Date:** 2025-12-13 17:52
**Files changed:** package.json
**Tags:** `dependency`

Updated JavaScript dependencies including @mariozechner/pi-ai and pi-coding-agent to version 0.20.2, @types/node to 25.0.1, lucide to 0.561.0, and rolldown to 1.0.0-beta.54.

---

## 01302 — fix(mac): flatten debug sections + use checkboxes
**SHA:** 61ab07ced3 · **Date:** 2025-12-13 17:57
**Files changed:** apps/macos/Sources/Clawdis/DebugSettings.swift
**Tags:** `fix`, `ui`

Refactored Debug Settings to flatten visual hierarchy using a custom PlainSettingsGroupBoxStyle and converted toggle switches to checkboxes for better consistency throughout the debug interface.

---

## 01303 — fix(ios): improve bridge discovery and pairing UX
**SHA:** 7c3502f031 · **Date:** 2025-12-13 17:58
**Files changed:** apps/ios/Sources/Bridge/BridgeClient.swift, BridgeDiscoveryModel.swift, BridgeEndpointID.swift, src/gateway/server.ts, src/infra/machine-name.ts
**Tags:** `fix`, `ux`, `api`

Improved iOS bridge discovery with status callbacks, timeout handling, better pairing approval feedback, and added machine display name detection for Bonjour advertising. Refactored bridge communication to report connection status updates to the user interface.

---

## 01304 — fix(mac): flatten config sections + use checkboxes
**SHA:** a0cd761c96 · **Date:** 2025-12-13 18:06
**Files changed:** apps/macos/Sources/Clawdis/ConfigSettings.swift
**Tags:** `fix`, `ui`

Unified configuration settings styling using the PlainSettingsGroupBoxStyle and converted toggle switches to checkboxes for consistent visual design across Web Chat and Browser configuration sections.

---

## 01305 — chore(peekaboo): bump submodule
**SHA:** 867d7e5d25 · **Date:** 2025-12-13 18:09
**Files changed:** Peekaboo
**Tags:** `chore`

Updated Peekaboo submodule to latest commit.

---

## 01306 — feat(browser): clamp screenshots under 5MB
**SHA:** 56fe23549c · **Date:** 2025-12-13 18:08
**Files changed:** src/browser/cdp.ts, screenshot.test.ts, screenshot.ts, server.ts
**Tags:** `core-feature`, `performance`

Implemented intelligent screenshot normalization that automatically resizes and compresses oversized screenshots to stay under 5MB while maintaining visual quality. Added comprehensive test coverage for screenshot sizing across various quality levels.

---

## 01307 — test(mac): cover codesign + node manager paths
**SHA:** 0c8b5ed59a · **Date:** 2025-12-13 18:08
**Files changed:** apps/macos/Sources/Clawdis/ControlSocketServer.swift, Utilities.swift, Tests/ClawdisIPCTests/ControlSocketServerTests.swift, NodeManagerPathsTests.swift
**Tags:** `testing`, `refactor`

Added test coverage for code signature team identifier lookups and node manager binary path resolution (Volta, asdf, fnm, nvm). Exposed test helpers and refactored path resolution to be testable.

---

## 01308 — fix(mac): clarify attach-only gateway errors
**SHA:** 94ad808028 · **Date:** 2025-12-13 18:09
**Files changed:** apps/macos/Sources/Clawdis/ControlChannel.swift, GatewayProcessManager.swift
**Tags:** `fix`, `error-handling`, `ux`

Improved error messaging when "Attach-only gateway" mode is enabled and the gateway cannot be reached, providing clearer guidance to users on why the connection failed and how to resolve it.

---

## 01309 — chore(webchat): refresh bundled assets
**SHA:** 40c66b1741 · **Date:** 2025-12-13 18:09
**Files changed:** (large bundled assets)
**Tags:** `chore`, `ui`

Updated bundled WebChat assets to reflect recent UI and styling changes.

---

## 01310 — fix(mac): place debug menu under Settings
**SHA:** 2a71c20ee4 · **Date:** 2025-12-13 18:10
**Files changed:** apps/macos/Sources/Clawdis/MenuContentView.swift
**Tags:** `fix`, `ui`

Reorganized the main menu by moving the Debug menu from the top-level menu bar to the Settings panel for cleaner UI structure.

---

## 01311 — fix(browser): accept targetId prefixes
**SHA:** 238afbc2f8 · **Date:** 2025-12-13 18:16
**Files changed:** src/browser/server.ts, target-id.js
**Tags:** `fix`, `api`

Extended browser tab targeting to accept targetId prefixes and handle ambiguous matches, allowing commands to work with partial tab identifiers.

---

## 01312 — fix(macos): show full browser tab ids
**SHA:** 537c515dde · **Date:** 2025-12-13 18:16
**Files changed:** apps/macos/Package.swift, ClawdisCLI/BrowserCLI.swift
**Tags:** `fix`, `ui`

Modified the browser CLI to display the full targetId under each tab entry in addition to the short ID, improving debuggability when selecting specific tabs.

---

## 01313 — fix(bridge): prefer bonjour TXT displayName
**SHA:** 3b853b329f · **Date:** 2025-12-13 18:31
**Files changed:** apps/ios/Sources/Bridge/BridgeClient.swift
**Tags:** `fix`, `api`

Fixed buffer management in bridge client by switching to instance-level buffer tracking instead of per-call buffers, ensuring correct frame reception across multiple bridge operations.

---

## 01314 — feat(browser): add DOM inspection commands
**SHA:** 7b675864a8 · **Date:** 2025-12-13 18:32
**Files changed:** apps/macos/Package.resolved, ClawdisCLI/BrowserCLI.swift
**Tags:** `core-feature`, `api`

Added new DOM inspection command line options (--await, --js, --selector, etc.) to the browser CLI for querying and interacting with page elements directly.

---

## 01315 — chore(peekaboo): update bridge host TeamID check
**SHA:** e3379b960e · **Date:** 2025-12-13 18:35
**Files changed:** Peekaboo
**Tags:** `chore`

Updated Peekaboo submodule with improvements to bridge host TeamID validation.

---

## 01316 — fix(browser): apply clawd theme color
**SHA:** 7cdd7c5333 · **Date:** 2025-12-13 18:41
**Files changed:** src/browser/chrome.ts
**Tags:** `fix`, `ui`

Implemented Chrome profile decoration with the clawd theme color by parsing hex RGB values to signed ARGB integers and applying them to Chrome's browser theme preferences.

---

## 01317 — chore(deps): add playwright-core
**SHA:** a59cfa7670 · **Date:** 2025-12-13 18:48
**Files changed:** package.json
**Tags:** `dependency`

Added playwright-core 1.57.0 as a dependency for browser automation capabilities.

---

## 01318 — feat(browser): add ai snapshot refs + click
**SHA:** ba22890205 · **Date:** 2025-12-13 18:48
**Files changed:** docs/agents.md, src/browser/client.ts
**Tags:** `core-feature`, `api`, `documentation`

Introduced new AI snapshot format with clickable reference IDs ([ref=…]) and added browserClickRef function to support agent-driven UI interaction through snapshot references.

---

## 01319 — fix(ios): avoid actor-isolated access from audio tap
**SHA:** 920cc9ac38 · **Date:** 2025-12-13 19:14
**Files changed:** apps/ios/Sources/Voice/VoiceWakeManager.swift
**Tags:** `fix`, `error-handling`

Fixed actor isolation compliance in VoiceWakeManager by properly typing the audio tap callback block and storing it before installation to avoid crossing actor boundaries.

---

## 01320 — chore(macos): expose remote test helper
**SHA:** 02fe19effa · **Date:** 2025-12-13 19:22
**Files changed:** apps/macos/Sources/Clawdis/GeneralSettings.swift, src/browser/chrome.ts
**Tags:** `chore`, `testing`

Made the testRemote() method public to enable testing of remote gateway connections, and cleaned up minor formatting in chrome.ts.

---

## 01321 — style(macos): tidy settings and CLI
**SHA:** 0b990443de · **Date:** 2025-12-13 19:23
**Files changed:** apps/macos/Sources/Clawdis/ClawdisConfigFile.swift, ConfigSettings.swift, CronSettings.swift
**Tags:** `cleanup`, `ui`

Removed trailing blank lines and reformatted long text strings in settings files for consistency.

---

## 01322 — refactor: apply stashed bridge + CLI changes
**SHA:** e2a93e17f9 · **Date:** 2025-12-13 19:30
**Files changed:** apps/ios/Sources/Bridge/BridgeClient.swift, src/Model/NodeAppModel.swift
**Tags:** `refactor`, `api`

Refactored BridgeClient to accept a BridgeHello parameter object instead of individual parameters, reducing argument list complexity and improving maintainability.

---

## 01323 — fix(macos): restore control + webchat build
**SHA:** 39c232548c · **Date:** 2025-12-13 19:38
**Files changed:** apps/macos/Sources/Clawdis/ControlRequestHandler.swift
**Tags:** `fix`

Fixed indentation and formatting in ControlRequestHandler for proper control request dispatch and pause handling logic.

---

## 01324 — chore(swift): run swiftformat and clear swiftlint
**SHA:** 6143338116 · **Date:** 2025-12-13 19:53
**Files changed:** apps/ios/Sources/Bridge/BridgeClient.swift, src/Model/NodeAppModel.swift
**Tags:** `cleanup`, `refactor`

Ran SwiftFormat to apply consistent code formatting across iOS bridge and model files, and resolved SwiftLint violations.

---

## 01325 — fix(ci): stabilize runners
**SHA:** 5a1687484c · **Date:** 2025-12-13 20:04
**Files changed:** .github/workflows/ci.yml, src/infra/restart.ts
**Tags:** `devops`, `fix`

Fixed CI workflow stability by adding recursive submodule checkout, updating bun download URL to bypass GitHub API rate limiting, and adding platform guards to avoid non-macOS restart attempts.

---

## 01326 — fix: harden pi package resolution
**SHA:** 41dd3b11b7 · **Date:** 2025-12-13 20:37
**Files changed:** src/agents/pi-path.ts
**Tags:** `fix`, `refactor`

Improved pi package binary resolution by switching to ESM import.meta.resolve() with fallback filesystem walking, removing dependency on createRequire and improving compatibility across module systems.

---

## 01327 — test: raise vitest coverage
**SHA:** cf28ea0d1c · **Date:** 2025-12-13 20:37
**Files changed:** src/agents/index.test.ts, pi-path.test.ts
**Tags:** `testing`

Added comprehensive test suite for agent index and pi-path binary resolution, including mocking and branch coverage scenarios.

---

## 01328 — chore: bump Peekaboo submodule
**SHA:** 01eba1b8d9 · **Date:** 2025-12-13 20:46
**Files changed:** .gitignore, Peekaboo
**Tags:** `chore`, `cleanup`

Updated Peekaboo submodule and added .DS_Store to .gitignore for cleaner repository state.

---

## 01329 — iOS: disable VoiceWake on Simulator
**SHA:** ceb3980b93 · **Date:** 2025-12-13 20:52
**Files changed:** apps/ios/Sources/Voice/VoiceWakeManager.swift
**Tags:** `fix`, `testing`

Disabled VoiceWake functionality when running on iOS Simulator due to unreliable audio stack and CoreAudio deadlock issues, improving simulator testing stability.

---

## 01330 — fix(macos): clamp web chat to visible frame
**SHA:** ece8a3e701 · **Date:** 2025-12-13 22:38
**Files changed:** apps/macos/Sources/Clawdis/WebChatSwiftUI.swift, WebChatWindow.swift
**Tags:** `fix`, `ui`

Improved web chat window positioning to clamp to visible screen bounds using visibleFrame instead of full frame, preventing windows from positioning off-screen or behind menu bars.

---

## 01331 — chore: bump Peekaboo submodule
**SHA:** 0d3aacd316 · **Date:** 2025-12-13 23:02
**Files changed:** Peekaboo, docs/clawdis-mac.md
**Tags:** `chore`, `documentation`

Updated Peekaboo submodule and clarified documentation around PeekabooBridge socket usage and UI automation routing.

---

## 01332 — chore(peekaboo): update submodule
**SHA:** a31a569d52 · **Date:** 2025-12-13 22:45
**Files changed:** Peekaboo
**Tags:** `chore`

Updated Peekaboo submodule to latest version.

---

## 01333 — style(macos): mark Reject destructive
**SHA:** d96bc38bea · **Date:** 2025-12-13 23:29
**Files changed:** apps/macos/Sources/Clawdis/Bridge/BridgeServer.swift, NodePairingApprovalPrompter.swift
**Tags:** `ui`, `cleanup`

Marked "Reject" button as destructive action in bridge pairing and node pairing approval dialogs for better visual feedback on macOS 11+.

---

## 01334 — iOS: copy + clean bridge address
**SHA:** 7a6334d920 · **Date:** 2025-12-13 23:29
**Files changed:** apps/ios/Sources/Bridge/BridgeSession.swift, Settings/SettingsTab.swift
**Tags:** `fix`, `ux`

Improved iOS bridge address display by cleaning up IPv6 addresses (removing ::ffff: IPv4 mapping prefix), properly formatting bracketed addresses for IPv6, and adding contextual copy options for host and port.

---

## 01335 — iOS: show local IP in settings
**SHA:** 7642cbb5b7 · **Date:** 2025-12-13 23:37
**Files changed:** apps/ios/Sources/Settings/SettingsTab.swift
**Tags:** `core-feature`, `ux`

Added display of the device's primary IPv4 address in iOS settings with one-tap copy functionality, helping users identify their iOS node on the network.

---

## 01336 — iOS: copy bridge URL/host/port
**SHA:** b01cb41950 · **Date:** 2025-12-13 23:40
**Files changed:** apps/ios/Sources/Settings/SettingsTab.swift
**Tags:** `core-feature`, `ux`

Extended iOS settings with separate copy options for bridge URL, host, and port in the context menu, allowing granular control over which address component to share or document.

---

## 01337 — feat(gateway): add node.invoke for iOS canvas
**SHA:** 3fcee21ff7 · **Date:** 2025-12-13 23:45
**Files changed:** docs/ios/spec.md, src/cli/nodes-cli.ts
**Tags:** `core-feature`, `api`, `documentation`

Introduced node.invoke gateway method for sending commands to iOS and other paired nodes, including screen.eval and screen.snapshot for Canvas control, with CLI support and documented examples.

---

## 01338 — iOS: configurable voice wake words
**SHA:** b508f642b2 · **Date:** 2025-12-13 23:49
**Files changed:** apps/ios/Sources/Settings/SettingsTab.swift, VoiceWakeWordsSettingsView.swift
**Tags:** `core-feature`, `ux`

Added new VoiceWakeWordsSettingsView to iOS app allowing users to configure custom trigger words for voice activation instead of hardcoded defaults.

---

## 01339 — refactor(macos)!: remove clawdis-mac ui; host PeekabooBridge
**SHA:** cf3becfb2e · **Date:** 2025-12-13 23:49
**Files changed:** apps/macos/Package.swift, ControlRequestHandler.swift
**Tags:** `refactor`, `core-feature`

Major refactor removing the clawdis-mac UI automation subcommands; Clawdis.app now hosts the PeekabooBridge socket and UI automation routes through the separate peekaboo CLI instead of internal commands.

---

## 01340 — docs(ios): add Iris connection runbook
**SHA:** 765c466d6d · **Date:** 2025-12-13 23:49
**Files changed:** docs/ios/connect.md (new)
**Tags:** `documentation`

Created comprehensive iOS node connection runbook documenting prerequisites, Bonjour discovery verification, pairing flow, and Canvas control examples for Iris integration.

---

## 01341 — docs(readme): describe macOS + iOS companion apps
**SHA:** 755e329b01 · **Date:** 2025-12-13 23:50
**Files changed:** README.md
**Tags:** `documentation`

Updated README with sections describing both the macOS companion app (Clawdis.app) and the iOS node prototype (Iris), including their capabilities and runbook reference.

---

## 01342 — feat(instances): show OS version
**SHA:** a53d8ed4e4 · **Date:** 2025-12-13 23:46
**Files changed:** apps/macos/Sources/Clawdis/InstancesSettings.swift
**Tags:** `core-feature`, `ux`

Added OS version detection and display in the Instances settings tab with appropriate platform icons (macOS, iOS, iPadOS, tvOS, watchOS) for each connected node.

---

## 01343 — chore(protocol): regen swift models
**SHA:** 17e183f5cf · **Date:** 2025-12-13 23:49
**Files changed:** apps/macos/Sources/ClawdisProtocol/GatewayModels.swift
**Tags:** `chore`, `api`

Regenerated Swift protocol models including new NodeInvokeParams struct for node.invoke RPC method with proper camelCase to snake_case JSON mapping.

---

## 01344 — fix(gateway): resolve iOS node invokes
**SHA:** aef18b7359 · **Date:** 2025-12-14 00:00
**Files changed:** src/cli/nodes-cli.ts
**Tags:** `fix`, `api`

Extended node CLI to support flexible node selection by ID, display name, IP address or unambiguous prefix, improving usability when invoking commands on remote nodes.

---

## 01345 — docs(ios): update Iris connect runbook
**SHA:** c286573f5c · **Date:** 2025-12-14 00:08
**Files changed:** docs/ios/connect.md
**Tags:** `documentation`, `refactor`

Updated iOS connection runbook with clearer node selection guidance, improved examples supporting display names and IPs, and legacy guidance removal.

---

## 01346 — feat(chat): share SwiftUI chat across macOS+iOS
**SHA:** e6d522493b · **Date:** 2025-12-14 00:17
**Files changed:** apps/ios/Sources/Bridge/BridgeSession.swift
**Tags:** `core-feature`, `refactor`

Implemented RPC request/response handling and server event broadcasting in BridgeSession to support shared SwiftUI chat interface between macOS and iOS platforms.

---

## 01347 — feat(ios): reconnect to last bridge
**SHA:** f7076c38ea · **Date:** 2025-12-14 00:23
**Files changed:** apps/ios/Sources/Bridge/BridgeConnectionController.swift (new)
**Tags:** `core-feature`

Created BridgeConnectionController to manage iOS bridge discovery and auto-reconnection to the last known bridge when stored credentials are available, improving user experience for repeated connections.

---

## 01348 — chore(mac): bump Peekaboo submodule
**SHA:** 30a2e47390 · **Date:** 2025-12-14 00:32
**Files changed:** Peekaboo
**Tags:** `chore`

Updated Peekaboo submodule to latest commit.

---

## 01349 — docs(changelog): add 2.0.0-beta1 entry
**SHA:** a9e1eabcbd · **Date:** 2025-12-14 00:34
**Files changed:** CHANGELOG.md
**Tags:** `documentation`

Added comprehensive 2.0.0-beta1 changelog entry documenting the Gateway architecture, macOS companion app, iOS node (Iris), node pairing, and all major feature additions.

---

## 01350 — docs(readme): reflect gateway + companion apps
**SHA:** 2710841801 · **Date:** 2025-12-14 00:34
**Files changed:** README.md
**Tags:** `documentation`

Updated README to reflect the new Gateway architecture diagram, feature highlights including the macOS and iOS companion apps, and clearer description of system topology.

---
