# Commit Reference: 01851–01900

A plain factual summary of every commit in the OpenClaw repository, from commit 1851 through commit 1900.

---

## 01851 — fix(macos): streamline onboarding ui
**SHA:** e800e84a77 · **Date:** 2025-12-20 15:20
**Files changed:** `apps/macos/Sources/Clawdis/GeneralSettings.swift`, `apps/macos/Sources/Clawdis/Onboarding.swift`, `apps/macos/Tests/ClawdisIPCTests/OnboardingViewSmokeTests.swift`
**Tags:** `ux`, `refactor`, `testing`

Refactored CLI button UI to use ZStack with opacity transitions for better loading state visibility. Removed workspace setup step (page 7) from local connection mode onboarding flow, streamlining the user experience. Added `ensureDefaultWorkspace()` function to automatically bootstrap default workspace during onboarding setup.

---

## 01852 — chore(agent): track upstream steerable loop
**SHA:** c7048973bb · **Date:** 2025-12-20 16:39
**Files changed:** `src/agents/pi-embedded.ts`
**Tags:** `refactor`, `logging`

Added TODO comment to track pending removal of steerable transport after upstream pi-mono PR #259 lands and dependencies are bumped. This marks technical debt related to agent loop implementation.

---

## 01853 — feat: advertise cli path for remote ssh
**SHA:** f03d2d1b33 · **Date:** 2025-12-20 16:43
**Files changed:** `apps/macos/Sources/Clawdis/AppState.swift`, `apps/macos/Sources/Clawdis/Constants.swift`, `apps/macos/Sources/Clawdis/GatewayDiscoveryModel.swift`, `apps/macos/Sources/Clawdis/GeneralSettings.swift`, `apps/macos/Sources/Clawdis/Onboarding.swift`, `apps/macos/Sources/Clawdis/Utilities.swift`, `docs/bonjour.md`, `docs/discovery.md`, `docs/mac/remote.md`, `src/gateway/server.ts`, `src/infra/bonjour.test.ts`, `src/infra/bonjour.ts`
**Tags:** `core-feature`, `api`, `documentation`, `config`, `devops`

Extended macOS app and gateway to support advertising CLI path through Bonjour service discovery. Added `remoteCliPath` state property to AppState for remote SSH configuration. Updated gateway to resolve and advertise CLI path hint, enabling remote SSH users to explicitly specify custom CLI binary locations. Includes documentation updates for bonjour discovery and remote setup flows.

---

## 01854 — refactor: extract canvas a2ui handler
**SHA:** a1b34ef0ef · **Date:** 2025-12-20 16:45
**Files changed:** `src/canvas-host/a2ui.ts`, `src/gateway/server.ts`
**Tags:** `refactor`, `api`

Extracted canvas a2ui (agent-to-UI) HTTP request handler into separate module for improved code organization and maintainability. Updated gateway server to import and use the extracted handler.

---

## 01855 — test: cover tailnet hello canvas host
**SHA:** ba85f4a62a · **Date:** 2025-12-20 16:45
**Files changed:** `src/canvas-host/hello.test.ts`
**Tags:** `testing`, `api`

Added test coverage for tailnet hello canvas host functionality, ensuring proper discovery and communication over tailnet connections.

---

## 01856 — feat(workspace): add bootstrap ritual
**SHA:** 3876c1679a · **Date:** 2025-12-20 15:48
**Files changed:** `src/workspace/bootstrap.ts`, `src/workspace/index.ts`
**Tags:** `core-feature`, `data-model`

Introduced workspace bootstrap ritual to automatically initialize default workspace directories and configuration. Provides structured initialization path for workspace creation with proper error handling and setup verification.

---

## 01857 — docs(onboarding): refine bootstrap convo
**SHA:** 80b3b9e00c · **Date:** 2025-12-20 15:54
**Files changed:** `docs/onboarding.md`, `docs/mac/onboarding.md`
**Tags:** `documentation`, `process-lifecycle`

Updated onboarding documentation to clarify bootstrap conversation flow and workspace initialization steps. Improved guidance for users going through the initial setup process.

---

## 01858 — fix(mac): align cli button height
**SHA:** 2288ec7384 · **Date:** 2025-12-20 16:02
**Files changed:** `apps/macos/Sources/Clawdis/GeneralSettings.swift`, `apps/macos/Sources/Clawdis/Onboarding.swift`
**Tags:** `ux`, `bugfix`

Fixed CLI button height alignment in onboarding UI by applying consistent frame dimensions. Ensures buttons maintain proper height during loading state transitions.

---

## 01859 — refactor: serve canvas host on gateway port
**SHA:** 65329496a7 · **Date:** 2025-12-20 17:13
**Files changed:** `src/gateway/server.ts`, `src/canvas-host/hello.test.ts`
**Tags:** `refactor`, `api`, `config`

Refactored canvas host configuration to serve on gateway port when appropriate, eliminating separate port configuration in certain scenarios. Improves deployment flexibility and reduces configuration complexity for remote setups.

---

## 01860 — refactor: remove canvasHost port config
**SHA:** bd572c775d · **Date:** 2025-12-20 17:15
**Files changed:** `src/config.ts`, `src/gateway/server.ts`
**Tags:** `refactor`, `config`, `cleanup`

Removed explicit canvasHost port configuration in favor of dynamic gateway port serving. Simplifies configuration surface and improves deployment defaults.

---

## 01861 — feat: refresh skills metadata and toggles
**SHA:** c4a67b7d02 · **Date:** 2025-12-20 17:23
**Files changed:** `src/skills/manager.ts`, `src/agents/pi-embedded.ts`
**Tags:** `core-feature`, `api`

Implemented skills metadata refresh and toggle functionality allowing dynamic skill availability updates. Agents can now query current skill state and adapt behavior based on enabled/disabled toggles without restart.

---

## 01862 — feat: add skills search and website
**SHA:** ba0791b896 · **Date:** 2025-12-20 17:31
**Files changed:** `src/skills/search.ts`, `src/web/pages/skills.tsx`, `docs/skills.md`
**Tags:** `core-feature`, `ui`, `documentation`

Added skills search functionality and created dedicated skills showcase website page. Users can now discover and search available skills with improved visibility and documentation of skill capabilities.

---

## 01863 — Merge remote-tracking branch 'origin/main'
**SHA:** 9c801e9c08 · **Date:** 2025-12-20 17:33
**Files changed:** (merge commit)
**Tags:** `process-lifecycle`

Merged upstream main branch to incorporate recent changes and resolve conflicts in codebase.

---

## 01864 — refactor: trim skill install spec
**SHA:** adc2900aff · **Date:** 2025-12-20 17:39
**Files changed:** `src/skills/installer.ts`, `src/cli/commands/skills.ts`
**Tags:** `refactor`, `cleanup`, `config`

Cleaned up skill installer specification by removing unnecessary configuration options and simplifying install command interface. Streamlines skill installation process.

---

## 01865 — refactor: drop pnpm skill installer
**SHA:** 4ee292a952 · **Date:** 2025-12-20 17:39
**Files changed:** `src/skills/installer.ts`, `docs/skills-install.md`
**Tags:** `refactor`, `dependency`, `cleanup`

Removed pnpm-based skill installer in favor of other package managers. Reduces dependency footprint and simplifies installer selection logic.

---

## 01866 — docs: update mac skills install types
**SHA:** b9eabe532e · **Date:** 2025-12-20 17:40
**Files changed:** `docs/mac/skills-install.md`
**Tags:** `documentation`, `api`

Updated macOS skill installation documentation with corrected type information and clearer examples. Improves developer experience for Mac-specific skill setup.

---

## 01867 — feat: add uv skill installers
**SHA:** 4c054917ef · **Date:** 2025-12-20 17:50
**Files changed:** `src/skills/installer.ts`, `src/skills/installers/uv.ts`, `docs/skills-install.md`
**Tags:** `core-feature`, `dependency`, `documentation`

Added support for uv-based Python package manager as skill installer option. Provides faster, more reliable Python skill installation alternative to existing managers.

---

## 01868 — refactor: tighten steerable agent loop typing
**SHA:** 0f271ab535 · **Date:** 2025-12-20 17:50
**Files changed:** `src/agents/steerable-loop.ts`, `src/agents/types.ts`
**Tags:** `refactor`, `api`

Improved type safety in steerable agent loop implementation by tightening type constraints and removing any assertions. Enhances code maintainability and catches potential runtime errors at compile time.

---

## 01869 — style: biome formatting
**SHA:** e618a21f4e · **Date:** 2025-12-20 17:50
**Files changed:** (multiple files)
**Tags:** `cleanup`, `build`

Applied biome code formatter across codebase to enforce consistent formatting standards. Ensures uniform code style throughout the repository.

---

## 01870 — feat(mac): add onboarding chat kickoff
**SHA:** 6b56f7d643 · **Date:** 2025-12-20 16:51
**Files changed:** `apps/macos/Sources/Clawdis/Onboarding.swift`, `apps/macos/Sources/Clawdis/ChatController.swift`
**Tags:** `core-feature`, `ux`, `ui`

Integrated chat interface into macOS onboarding flow, allowing users to interact with assistant during initial setup. Improves onboarding experience with interactive guidance.

---

## 01871 — feat(chat): restyle onboarding chat UI
**SHA:** 5936ed7941 · **Date:** 2025-12-20 16:51
**Files changed:** `src/web/components/ChatUI.tsx`, `src/web/styles/chat.css`
**Tags:** `ui`, `ux`, `core-feature`

Redesigned onboarding chat interface with improved visual hierarchy and interaction patterns. Enhanced typography, spacing, and message presentation for better user engagement.

---

## 01872 — feat(web): add whatsapp QR login tool
**SHA:** 4e491757ef · **Date:** 2025-12-20 16:51
**Files changed:** `src/web/tools/whatsapp-qr.tsx`, `src/web/pages/login.tsx`, `docs/web-auth.md`
**Tags:** `core-feature`, `ui`, `documentation`

Added WhatsApp QR code login option to web authentication flow. Users can now authenticate using WhatsApp QR scanning, expanding login method availability.

---

## 01873 — docs(onboarding): document chat kickoff
**SHA:** f3c4d1a181 · **Date:** 2025-12-20 16:51
**Files changed:** `docs/onboarding.md`, `docs/mac/onboarding.md`
**Tags:** `documentation`, `process-lifecycle`

Documented chat-based onboarding kickoff feature including activation requirements and user flows. Clarifies integration of chat assistant into onboarding process.

---

## 01874 — style: format skill installer logic
**SHA:** 7a88071a16 · **Date:** 2025-12-20 17:51
**Files changed:** `src/skills/installer.ts`
**Tags:** `cleanup`, `build`

Applied code formatting to skill installer logic for consistency. Improves code readability without functional changes.

---

## 01875 — test: mock embedded queue in auto-reply tests
**SHA:** 759ab8acbc · **Date:** 2025-12-20 18:00
**Files changed:** `src/agents/pi-embedded.test.ts`
**Tags:** `testing`

Enhanced auto-reply test suite by properly mocking embedded message queue. Improves test isolation and reduces flakiness in agent tests.

---

## 01876 — test: include token for canvas host hello
**SHA:** d3821123ee · **Date:** 2025-12-20 18:00
**Files changed:** `src/canvas-host/hello.test.ts`
**Tags:** `testing`, `api`

Updated canvas host hello tests to include authentication token in requests. Ensures proper token validation in hello endpoint testing.

---

## 01877 — fix: accept duplex upgrade sockets
**SHA:** f49c20c508 · **Date:** 2025-12-20 18:00
**Files changed:** `src/gateway/websocket.ts`
**Tags:** `bugfix`, `networking`, `api`

Fixed WebSocket upgrade handling to properly accept duplex socket connections. Resolves issues with certain client upgrade patterns.

---

## 01878 — docs: update summarize installer spec
**SHA:** 03a4e0c837 · **Date:** 2025-12-20 18:00
**Files changed:** `docs/skills-install.md`
**Tags:** `documentation`, `api`

Updated documentation for summarize skill installer specification with corrected parameters and examples.

---

## 01879 — style: satisfy swiftformat in chat composer
**SHA:** b13723d3d7 · **Date:** 2025-12-20 18:18
**Files changed:** `apps/macos/Sources/Clawdis/ChatComposer.swift`
**Tags:** `cleanup`, `build`

Applied swiftformat to chat composer code to meet iOS formatting standards. Maintains consistency with macOS codebase style guide.

---

## 01880 — fix: make web inbox non-blocking
**SHA:** ea5333e5f7 · **Date:** 2025-12-20 18:24
**Files changed:** `src/web/inbox.ts`
**Tags:** `bugfix`, `performance`, `networking`

Refactored web inbox message handling to non-blocking async operations. Prevents UI freezing when processing multiple messages simultaneously.

---

## 01881 — test: stabilize gateway sigterm startup
**SHA:** 8ec0d813c0 · **Date:** 2025-12-20 18:29
**Files changed:** `src/gateway/server.test.ts`
**Tags:** `testing`, `process-lifecycle`, `devops`

Improved gateway startup shutdown sequence test reliability by adding explicit cleanup and timing adjustments. Reduces flaky test failures during CI runs.

---

## 01882 — docs(templates): update workspace template guidance
**SHA:** cfd3efb6e7 · **Date:** 2025-12-20 17:35
**Files changed:** `docs/workspace-templates.md`
**Tags:** `documentation`, `process-lifecycle`

Updated workspace template documentation with clearer setup instructions and best practices. Helps users understand workspace structure and customization options.

---

## 01883 — docs(onboarding): add soul creation step
**SHA:** cdb2a0736a · **Date:** 2025-12-20 17:38
**Files changed:** `docs/onboarding.md`
**Tags:** `documentation`, `process-lifecycle`

Added documentation for soul/identity creation step in onboarding flow. Clarifies purpose and workflow of creating user identity during initialization.

---

## 01884 — chore: biome format
**SHA:** 5687a03f0b · **Date:** 2025-12-20 18:38
**Files changed:** (multiple files)
**Tags:** `cleanup`, `build`

Applied biome formatter across codebase to standardize formatting. Resolves linting issues and enforces consistent code style.

---

## 01885 — fix: detect main module under PM2
**SHA:** 49ec53f4ae · **Date:** 2025-12-20 18:39
**Files changed:** `src/cli/module-detection.ts`
**Tags:** `bugfix`, `devops`, `config`

Fixed module detection logic to correctly identify main module when running under PM2 process manager. Ensures CLI commands work properly in PM2-managed deployments.

---

## 01886 — docs: add ordercli skill
**SHA:** 1356498ee1 · **Date:** 2025-12-20 18:50
**Files changed:** `docs/skills.md`, `docs/skills-reference.md`
**Tags:** `documentation`, `api`

Added documentation for ordercli skill including usage examples and configuration options. Helps users understand and integrate order management capabilities.

---

## 01887 — fix: use file-type for mime sniffing
**SHA:** 36c85a617a · **Date:** 2025-12-20 19:13
**Files changed:** `src/gateway/mime-detection.ts`, `package.json`
**Tags:** `bugfix`, `dependency`, `api`

Replaced custom MIME type detection with file-type library for more reliable and comprehensive MIME detection. Improves file handling accuracy.

---

## 01888 — test: expand mime detection coverage
**SHA:** 96cbab2b22 · **Date:** 2025-12-20 19:16
**Files changed:** `src/gateway/mime-detection.test.ts`
**Tags:** `testing`, `api`

Extended MIME detection test suite with additional file types and edge cases. Ensures reliable MIME detection across diverse file formats.

---

## 01889 — fix: move host lookup off main thread
**SHA:** 943f0d475f · **Date:** 2025-12-20 19:26
**Files changed:** `src/gateway/discovery.ts`, `src/workers/dns-lookup.ts`
**Tags:** `bugfix`, `performance`, `networking`

Refactored DNS host lookup to run in worker thread instead of blocking main thread. Prevents UI freezing during network discovery operations.

---

## 01890 — fix: merge bonjour txt records for ssh autofill
**SHA:** 35e0894655 · **Date:** 2025-12-20 17:13
**Files changed:** `src/infra/bonjour-parser.ts`
**Tags:** `bugfix`, `api`, `config`

Fixed Bonjour TXT record parsing to properly merge multi-part records for SSH autofill functionality. Ensures complete SSH configuration extraction from service advertisements.

---

## 01891 — fix: resolve bonjour txt for ssh autofill
**SHA:** c38aeb1081 · **Date:** 2025-12-20 18:40
**Files changed:** `src/infra/bonjour-parser.ts`, `apps/macos/Sources/Clawdis/GatewayDiscoveryModel.swift`
**Tags:** `bugfix`, `api`, `config`

Improved Bonjour TXT record resolution specifically for SSH autofill data extraction. Ensures SSH connection parameters are reliably retrieved from gateway advertisements.

---

## 01892 — fix(web): handle self-chat mode
**SHA:** 929a10e33d · **Date:** 2025-12-20 19:31
**Files changed:** `src/web/pages/chat.tsx`, `src/gateway/chat-router.ts`
**Tags:** `bugfix`, `ui`, `api`

Fixed web chat component to properly handle self-chat mode where users chat with themselves. Corrects message routing and display for single-participant conversations.

---

## 01893 — fix: use local timestamps in agent envelope
**SHA:** 50e817f193 · **Date:** 2025-12-20 19:40
**Files changed:** `src/agents/envelope.ts`, `src/agents/timestamp.ts`
**Tags:** `bugfix`, `api`, `logging`

Changed agent envelope timestamp generation to use local time instead of UTC. Ensures timestamps in logs and traces reflect user's local timezone for easier debugging.

---

## 01894 — refactor: centralize gateway parsing
**SHA:** d159602928 · **Date:** 2025-12-20 19:53
**Files changed:** `src/gateway/parser.ts`, `src/infra/bonjour-parser.ts`, `apps/macos/Sources/Clawdis/GatewayDiscoveryModel.swift`
**Tags:** `refactor`, `api`, `cleanup`

Centralized gateway configuration parsing logic into dedicated module to eliminate duplication. Improves maintainability and ensures consistent parsing across platforms.

---

## 01895 — test: cover ssh autofill helpers
**SHA:** a44a313f77 · **Date:** 2025-12-20 19:53
**Files changed:** `src/infra/ssh-autofill.test.ts`
**Tags:** `testing`, `api`

Added comprehensive test coverage for SSH autofill helper functions. Ensures correct extraction and formatting of SSH connection parameters from gateway metadata.

---

## 01896 — chore(deps): add chromium-bidi and long
**SHA:** 750408d0a2 · **Date:** 2025-12-20 19:16
**Files changed:** `package.json`, `package-lock.json`
**Tags:** `dependency`, `build`, `devops`

Added chromium-bidi and long dependencies to support browser control functionality. These libraries enable protocol communication with Chrome DevTools.

---

## 01897 — fix(macos): patch bun Long for protobuf
**SHA:** c050a82c3a · **Date:** 2025-12-20 19:16
**Files changed:** `apps/macos/build/patch-bun-long.ts`
**Tags:** `bugfix`, `build`, `dependency`

Created patching script to fix bun's Long type implementation for protobuf compatibility. Resolves runtime errors when using protobuf serialization in macOS bundle.

---

## 01898 — fix(gateway): start browser control server
**SHA:** 21ac34bc6a · **Date:** 2025-12-20 19:16
**Files changed:** `src/gateway/server.ts`, `src/browser/control-server.ts`
**Tags:** `bugfix`, `api`, `devops`

Fixed gateway startup to properly initialize browser control server on boot. Enables browser automation and control functionality in gateway deployments.

---

## 01899 — build(macos): bundle playwright in embedded gateway
**SHA:** 1eb6d617f5 · **Date:** 2025-12-20 19:16
**Files changed:** `apps/macos/build.ts`, `apps/macos/Macos.toml`
**Tags:** `build`, `devops`, `dependency`

Updated macOS build configuration to include playwright browser library in embedded gateway bundle. Enables browser automation capabilities in standalone Mac app.

---

## 01900 — fix(browser): allow control server without playwright
**SHA:** ab4457e2a3 · **Date:** 2025-12-20 19:16
**Files changed:** `src/browser/control-server.ts`, `src/browser/types.ts`
**Tags:** `bugfix`, `api`, `dependency`

Modified browser control server initialization to work even when playwright is not available. Improves robustness by allowing graceful degradation in minimal environments.

---
