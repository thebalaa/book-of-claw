# Commit Reference: 00601–00650

A plain factual summary of every commit in the OpenClaw repository, from commit 601 through commit 650.

---

## 00601 — CLI: add health probe command
**SHA:** 2714ed503b · **Date:** 2025-12-07 04:33
**Files changed:** src/cli/program.ts, src/commands/health.ts, src/commands/health.test.ts, docs/health.md, docs/mac/health.md
**Tags:** `core-feature`, `documentation`, `testing`

Adds dedicated `clawdis health --json` command that probes WhatsApp Web health by loading credentials, attempting a short Baileys connect, and reporting status without sending messages. Command exits non-zero if not linked or if connection fails, and supports `--timeout` and `--verbose` flags. Includes unit tests for linked/unlinked scenarios and documentation for CLI and planned macOS integration.

---

## 00602 — Settings: move session store path to Debug
**SHA:** ddf8aef4f7 · **Date:** 2025-12-07 04:38
**Files changed:** apps/macos/Sources/Clawdis/ConfigSettings.swift, apps/macos/Sources/Clawdis/DebugSettings.swift
**Tags:** `ux`, `refactor`

Moves session store path configuration from General settings to Debug settings in macOS app. Session store path input now lives in DebugSettings with explicit Save button and error handling. ConfigSettings refactored to extract `loadConfigDict()` helper and remove session store handling.

---

## 00603 — Health: CLI probe and mac UI surfacing
**SHA:** cb5c932447 · **Date:** 2025-12-07 04:38
**Files changed:** apps/macos/Sources/Clawdis/GeneralSettings.swift, apps/macos/Sources/Clawdis/HealthStore.swift, apps/macos/Sources/Clawdis/MenuBar.swift, docs/health.md, docs/mac/health.md, src/web/auto-reply.ts, src/web/login.coverage.test.ts, src/web/login.test.ts
**Tags:** `core-feature`, `ux`, `testing`

Implements macOS health monitoring UI by introducing HealthStore that polls `clawdis health --json` every 60 seconds. Adds health status card to General settings showing link status, auth age, session store details, and last check time with color-coded state (green/orange/red). Menu bar gains health status row with dot indicator. Updates documentation to reflect shipped features.

---

## 00604 — docs: add voice wake forwarding tips to agents
**SHA:** 3d89999a06 · **Date:** 2025-12-07 05:30
**Files changed:** AGENTS.md
**Tags:** `documentation`

Adds voice wake forwarding tips to AGENTS.md including command template quoting rules, launchd PATH requirements for pnpm/clawdis resolution, and heredoc pattern for messages containing exclamation marks. Documents that VoiceWakeForwarder handles shell escaping automatically.

---

## 00605 — fix: reuse resolver for agent rpc launch
**SHA:** 4645f512d1 · **Date:** 2025-12-07 05:34
**Files changed:** apps/macos/Sources/Clawdis/AgentRPC.swift, apps/macos/Sources/Clawdis/RelayProcessManager.swift, apps/macos/Sources/Clawdis/Utilities.swift, apps/macos/Sources/Clawdis/XPCService.swift
**Tags:** `refactor`, `bugfix`

Extracts command resolution logic into shared CommandResolver utility to eliminate duplication across AgentRPC, RelayProcessManager, and XPCService. CommandResolver centralizes project root management, PATH construction, executable discovery, and clawdis command building with fallbacks (clawdis binary → node + script → pnpm → bare command). All process spawns now use CommandResolver and inject proper PATH environment.

---

## 00606 — test: cover command resolver fallbacks
**SHA:** f32a647a20 · **Date:** 2025-12-07 05:36
**Files changed:** apps/macos/Tests/ClawdisIPCTests/CommandResolverTests.swift
**Tags:** `testing`

Adds CommandResolverTests covering binary preference order and fallback logic. Tests verify that resolver prefers clawdis binary when available, falls back to node + script when clawdis missing, and constructs correct command arrays with subcommands.

---

## 00607 — chore: fix test import and lint
**SHA:** 3a8e049093 · **Date:** 2025-12-07 05:38
**Files changed:** apps/macos/Tests/ClawdisIPCTests/CommandResolverTests.swift
**Tags:** `linting`, `testing`

Fixes test import statement and linting issues in CommandResolverTests.

---

## 00608 — Health: strengthen probe tests
**SHA:** 1190b9c278 · **Date:** 2025-12-07 04:39
**Files changed:** src/commands/health.test.ts
**Tags:** `testing`

Strengthens health command unit tests by adding coverage for unlinked scenario with non-zero exit and improving assertions on JSON output structure including web.linked, web.connect.ok, and sessions.count fields.

---

## 00609 — UI: streamline relay status label
**SHA:** 2abc51789e · **Date:** 2025-12-07 04:39
**Files changed:** apps/macos/Sources/Clawdis/MenuBar.swift
**Tags:** `ux`

Simplifies relay status label formatting in menu bar to show cleaner status text.

---

## 00610 — Docs: scrub personal phone example
**SHA:** fdc0b283d7 · **Date:** 2025-12-07 04:40
**Files changed:** docs/health.md
**Tags:** `documentation`

Removes personal phone number from health documentation example.

---

## 00611 — Docs: swap to obviously fake phone numbers
**SHA:** 67c67dd86d · **Date:** 2025-12-07 04:42
**Files changed:** README.md, docs/health.md, src/config/sessions.test.ts, src/web/auto-reply.test.ts
**Tags:** `documentation`

Replaces all real-looking phone numbers in documentation and tests with obviously fake placeholder numbers like +1555000.

---

## 00612 — Docs: add no-real-data rule to AGENTS
**SHA:** 753995a91d · **Date:** 2025-12-07 04:43
**Files changed:** AGENTS.md
**Tags:** `documentation`

Adds explicit rule to AGENTS.md prohibiting commit of real phone numbers, credentials, or personal data in examples and tests.

---

## 00613 — chore(health): kick off health refresh at app launch
**SHA:** b20507ef0a · **Date:** 2025-12-07 05:43
**Files changed:** apps/macos/Sources/Clawdis/HealthStore.swift
**Tags:** `core-feature`

Triggers immediate health check on HealthStore initialization so macOS app shows health status right away instead of waiting 60 seconds for first poll.

---

## 00614 — fix: raise voice wake forward timeout to 30s
**SHA:** 17aeec59a3 · **Date:** 2025-12-07 05:46
**Files changed:** apps/macos/Sources/Clawdis/VoiceWakeForwarder.swift
**Tags:** `bugfix`

Increases voice wake SSH forwarding timeout from default to 30 seconds to accommodate slower agent responses and network latency.

---

## 00615 — fix(health): reveal logs alerts when missing; align actions
**SHA:** 1ae0b44bc5 · **Date:** 2025-12-07 05:46
**Files changed:** apps/macos/Sources/Clawdis/GeneralSettings.swift
**Tags:** `bugfix`, `ux`

Fixes Reveal Logs button to show alert when log file doesn't exist. Aligns health action buttons horizontally for better layout.

---

## 00616 — fix: keep launch agent alive and inject PATH
**SHA:** 093e737af9 · **Date:** 2025-12-07 05:49
**Files changed:** apps/macos/scripts/install-launch-agent.sh, apps/macos/Resources/com.anthropic.clawdis.plist.template
**Tags:** `bugfix`, `process-lifecycle`

Adds KeepAlive to launchd plist and injects proper PATH environment including Homebrew and pnpm directories so launch agent can find binaries when running in background without user session.

---

## 00617 — fix: auto-start rpc worker for agent calls
**SHA:** e70f8471a8 · **Date:** 2025-12-07 05:54
**Files changed:** apps/macos/Sources/Clawdis/AgentRPC.swift
**Tags:** `bugfix`, `process-lifecycle`

Attempts to auto-start RPC worker process when agent calls are made but worker not running. Reverted in next commit.

---

## 00618 — Revert "fix: auto-start rpc worker for agent calls"
**SHA:** 1d38f5a4d5 · **Date:** 2025-12-07 05:54
**Files changed:** apps/macos/Sources/Clawdis/AgentRPC.swift
**Tags:** `refactor`

Reverts commit e70f8471a8 which attempted auto-starting RPC worker for agent calls.

---

## 00619 — agent: deliver via rpc and voice forward
**SHA:** 67fa82cf14 · **Date:** 2025-12-07 06:05
**Files changed:** apps/macos/Sources/Clawdis/VoiceWakeForwarder.swift, src/commands/agent.ts
**Tags:** `core-feature`

Enables `--deliver` flag on agent command to send response via RPC deliver method. VoiceWakeForwarder updated to pass `--deliver` in default voice wake forward command so agent responses route back through WhatsApp automatically.

---

## 00620 — chore(macos): remove focus ring on about icon
**SHA:** f97415755b · **Date:** 2025-12-07 14:46
**Files changed:** apps/macos/Sources/Clawdis/AboutSettings.swift
**Tags:** `ux`

Removes blue focus ring from about icon button for cleaner appearance.

---

## 00621 — chore(macos): make debug settings scrollable
**SHA:** 4d2f4f1be3 · **Date:** 2025-12-07 14:48
**Files changed:** apps/macos/Sources/Clawdis/DebugSettings.swift
**Tags:** `ux`

Wraps debug settings in ScrollView to handle overflow when many debug controls are present.

---

## 00622 — fix(macos): resolve clawdis path for health check
**SHA:** 28b531593a · **Date:** 2025-12-07 14:49
**Files changed:** apps/macos/Sources/Clawdis/HealthStore.swift
**Tags:** `bugfix`

Uses CommandResolver to build health check command with proper PATH resolution instead of bare "clawdis" command which fails when binary not in PATH.

---

## 00623 — chore(macos): clean up CLI helper subtext
**SHA:** ff41a61432 · **Date:** 2025-12-07 14:49
**Files changed:** apps/macos/Sources/Clawdis/GeneralSettings.swift
**Tags:** `ux`, `documentation`

Improves CLI helper installation status subtext for clarity.

---

## 00624 — chore(macos): align mic level bar width
**SHA:** 809f5d6d8e · **Date:** 2025-12-07 14:52
**Files changed:** apps/macos/Sources/Clawdis/VoiceWakeSettings.swift
**Tags:** `ux`

Adjusts microphone level bar width to align with other controls in voice wake settings.

---

## 00625 — chore(macos): align recognition language row styling
**SHA:** 42c74e864a · **Date:** 2025-12-07 14:52
**Files changed:** apps/macos/Sources/Clawdis/VoiceWakeSettings.swift
**Tags:** `ux`

Aligns speech recognition language picker styling with adjacent controls.

---

## 00626 — chore(macos): simplify health status menu and messaging
**SHA:** a23846b3a1 · **Date:** 2025-12-07 14:54
**Files changed:** apps/macos/Sources/Clawdis/HealthStore.swift, apps/macos/Sources/Clawdis/MenuBar.swift
**Tags:** `ux`

Simplifies health status messaging in menu bar to show more concise status text and clearer error states.

---

## 00627 — macOS: widen voice wake label spacing
**SHA:** 175f929023 · **Date:** 2025-12-07 13:57
**Files changed:** apps/macos/Sources/Clawdis/VoiceWakeSettings.swift
**Tags:** `ux`

Increases horizontal spacing on voice wake labels for better readability.

---

## 00628 — ci: use macos-latest with Xcode 26.1
**SHA:** 15381c7832 · **Date:** 2025-12-07 15:00
**Files changed:** .github/workflows/macos-build.yml
**Tags:** `testing`

Updates CI workflow to use macos-latest runner image with Xcode 26.1 for macOS builds.

---

## 00629 — debug: add voice forward test button
**SHA:** 9c9e04c5a0 · **Date:** 2025-12-07 15:00
**Files changed:** apps/macos/Sources/Clawdis/DebugSettings.swift
**Tags:** `ux`, `testing`

Adds test button to debug settings for triggering voice wake forward command manually with test message.

---

## 00630 — fix(macos): handle missing clawdis CLI for health check
**SHA:** 96ae0dd23a · **Date:** 2025-12-07 15:03
**Files changed:** apps/macos/Sources/Clawdis/HealthStore.swift
**Tags:** `bugfix`

Improves error handling when clawdis CLI not found during health check to prevent crashes and show helpful error message.

---

## 00631 — fix(macos): honor pnpm/node when locating clawdis for health
**SHA:** a3bf0d6002 · **Date:** 2025-12-07 15:07
**Files changed:** apps/macos/Sources/Clawdis/HealthStore.swift, apps/macos/Sources/Clawdis/ShellRunner.swift
**Tags:** `bugfix`

Updates HealthStore and ShellRunner to use CommandResolver for building clawdis health command, ensuring pnpm and node fallbacks work correctly when clawdis binary not in PATH.

---

## 00632 — debug: surface ssh error details in voice test
**SHA:** 76559b352b · **Date:** 2025-12-07 15:07
**Files changed:** apps/macos/Sources/Clawdis/DebugSettings.swift
**Tags:** `ux`, `testing`

Surfaces detailed SSH error output in voice forward test button results for better debugging.

---

## 00633 — chore(macos): tighten voice wake control widths
**SHA:** eeee9625c1 · **Date:** 2025-12-07 15:09
**Files changed:** apps/macos/Sources/Clawdis/VoiceWakeSettings.swift
**Tags:** `ux`

Adjusts voice wake control widths to create tighter, more compact layout.

---

## 00634 — agent: allow deliver when json output
**SHA:** 2dbef6105d · **Date:** 2025-12-07 15:16
**Files changed:** src/commands/agent.ts
**Tags:** `bugfix`

Allows `--deliver` flag to work when `--json` output mode is enabled by sending response before JSON output is generated.

---

## 00635 — feat: add heartbeat toggle with live RPC control
**SHA:** b30db08110 · **Date:** 2025-12-07 15:32
**Files changed:** apps/macos/Sources/Clawdis/AgentRPC.swift, apps/macos/Sources/Clawdis/AppState.swift, apps/macos/Sources/Clawdis/Constants.swift, apps/macos/Sources/Clawdis/MenuBar.swift, src/cli/rpc.ts
**Tags:** `core-feature`

Adds heartbeat toggle to menu bar that enables/disables WhatsApp heartbeat messages via live RPC control. AgentRPC gains `setHeartbeatsEnabled()` method that sends `set-heartbeats` RPC command to running relay process. AppState persists heartbeat preference and syncs with RPC worker on change.

---

## 00636 — Debug: make voice wake test follow config
**SHA:** f6db636473 · **Date:** 2025-12-07 14:33
**Files changed:** apps/macos/Sources/Clawdis/DebugSettings.swift
**Tags:** `testing`, `ux`

Updates voice wake test button to use configured forward command and identity instead of hardcoded values so testing matches actual runtime behavior.

---

## 00637 — docs: record current rpc protocol and heartbeat toggle
**SHA:** 5986cf4254 · **Date:** 2025-12-07 15:33
**Files changed:** docs/rpc.md
**Tags:** `documentation`

Documents RPC protocol including `set-heartbeats` message type for live heartbeat control and response format.

---

## 00638 — chore(macos): enlarge about icon
**SHA:** 7dc9434aec · **Date:** 2025-12-07 15:34
**Files changed:** apps/macos/Sources/Clawdis/AboutSettings.swift
**Tags:** `ux`

Increases about icon size for better visual prominence.

---

## 00639 — Debug: surface detailed voice send errors
**SHA:** 75234da135 · **Date:** 2025-12-07 14:41
**Files changed:** apps/macos/Sources/Clawdis/DebugSettings.swift
**Tags:** `ux`, `testing`

Surfaces more detailed error messages when voice forward test fails including stderr output and process exit codes.

---

## 00640 — rpc: surface raw error lines and auto-start worker
**SHA:** ee845376b5 · **Date:** 2025-12-07 15:46
**Files changed:** apps/macos/Sources/Clawdis/AgentRPC.swift
**Tags:** `bugfix`, `ux`

Surfaces raw RPC error lines in failure messages for better debugging. Adds logic to auto-start RPC worker when needed for agent calls.

---

## 00641 — debug: hide helper subtext while sending
**SHA:** 4e2fb38d62 · **Date:** 2025-12-07 15:47
**Files changed:** apps/macos/Sources/Clawdis/DebugSettings.swift
**Tags:** `ux`

Hides CLI helper installation subtext while voice forward test is running to reduce visual clutter.

---

## 00642 — fix(mac): keep pnpm health output json-safe
**SHA:** f878e5e635 · **Date:** 2025-12-07 15:09
**Files changed:** apps/macos/Sources/Clawdis/ShellRunner.swift
**Tags:** `bugfix`

Ensures ShellRunner output for health checks remains valid JSON by handling stderr separately and avoiding stderr contamination of stdout.

---

## 00643 — General: add bottom inset to quit button
**SHA:** 9aea85a953 · **Date:** 2025-12-07 15:11
**Files changed:** apps/macos/Sources/Clawdis/GeneralSettings.swift
**Tags:** `ux`

Adds bottom padding to quit button in general settings for better spacing.

---

## 00644 — fix(macos): load web chat from bundled html
**SHA:** f4fa9bf51a · **Date:** 2025-12-07 16:10
**Files changed:** apps/macos/Sources/Clawdis/WebChatView.swift
**Tags:** `bugfix`

Loads web chat UI from bundled HTML file in app resources instead of external source to ensure offline availability.

---

## 00645 — voice wake: surface ssh failures (missing key/no output)
**SHA:** ba0f594548 · **Date:** 2025-12-07 16:13
**Files changed:** apps/macos/Sources/Clawdis/VoiceWakeForwarder.swift
**Tags:** `bugfix`, `ux`

Improves voice wake error reporting to detect and surface SSH authentication failures including missing identity files and empty output scenarios.

---

## 00646 — chore(macos): allow file access for web chat modules
**SHA:** 73133b61fb · **Date:** 2025-12-07 16:14
**Files changed:** apps/macos/Clawdis.entitlements
**Tags:** `bugfix`

Adds file access entitlements needed for web chat to load bundled JavaScript modules.

---

## 00647 — Icon: add ear holes on voice wake
**SHA:** 3387c135ad · **Date:** 2025-12-07 16:15
**Files changed:** apps/macos/Sources/Clawdis/VoiceWakeSettings.swift
**Tags:** `ux`

Updates voice wake icon with ear hole visual detail.

---

## 00648 — voice wake: show identity not found when configured
**SHA:** ddd459426d · **Date:** 2025-12-07 16:18
**Files changed:** apps/macos/Sources/Clawdis/VoiceWakeForwarder.swift
**Tags:** `bugfix`, `ux`

Shows specific "identity file not found" error when configured SSH identity file doesn't exist at specified path.

---

## 00649 — voice wake: keep default key when identity is blank
**SHA:** 139697b9cd · **Date:** 2025-12-07 16:23
**Files changed:** apps/macos/Sources/Clawdis/VoiceWakeForwarder.swift
**Tags:** `bugfix`

Uses default SSH key discovery when identity field is left blank instead of erroring, allowing SSH to fall back to standard key locations.

---

## 00650 — chore: bump version to 2.0.0
**SHA:** 6f6c5129d1 · **Date:** 2025-12-07 16:28
**Files changed:** package.json
**Tags:** `naming`

Bumps package version from 1.4.0 to 2.0.0 marking major release milestone.

---
