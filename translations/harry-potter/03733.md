---
commit_number: 03733
commit_sha: "7294ba037d762983793baadf99a054674a30668a"
style: harry-potter
title: "A Map of the Windows Labyrinth"
author: claude-sonnet-4-6
date: 2026-02-17
---

<!-- Source: commit-diffs/03733-7294ba037d-browser- add Windows Chrome executable detection-/ -->

## The Translation

Mourad Boustani had always suspected that Windows kept its applications in places that made sense to no one except Windows. He had been correct.

He stood before the whiteboard in the Arithmancy classroom (repurposed, after hours, for software architecture) and drew three boxes. The first was labeled `LOCALAPPDATA`. The second was `Program Files`. The third, with a certain resigned flourish, was `Program Files (x86)`.

"The problem," he said to the assembled students, none of whom had asked to be here on a Tuesday evening, "is that Chrome can be in any of these places. Or Canary Chrome. Or Chromium." He drew additional boxes. The whiteboard was becoming crowded. "And the environment variable for the third box—" he tapped it with his chalk, "—cannot be accessed normally. Because its name contains *parentheses*."

A student in the front row raised a hand. "Why does it contain parentheses?"

"Windows," said Boustani simply, in the tone of a man who has made peace with an ancient adversary.

The solution, once devised, was a list — a list of five candidates, arranged from most to least preferred: Canary first, then Chromium, then Chrome user-install, then Chrome 64-bit system, then Chrome 32-bit system on 64-bit Windows, which had its own special path and its own special box on the increasingly crowded whiteboard. The code would walk down the list and return the first one that actually existed.

The tests confirmed that it worked: when the mock filesystem pretended only `Chrome SxS` existed, Canary was found. When only the `Program Files` path existed, Chrome was found. When nothing existed, nothing was returned, which is also correct behavior and arguably easier to test.

The final touch was a single line at the end of the platform-detection switch: `if (process.platform === 'win32') return findChromeExecutableWindows()`. And an update to the error message, which had previously implied that Chrome was only available "on macOS or Linux." Windows users had been reading that error for some time. It seemed polite to correct it.

## The Changes

Added `findChromeExecutableWindows()` which checks five candidate paths across `LOCALAPPDATA`, `ProgramFiles`, and `ProgramFiles(x86)` for Chrome Canary, Chromium, and Chrome (user and system installs). The function is now called when `process.platform === 'win32'`, and the "no browser found" error message was updated to include Windows. Three tests cover the Canary preference, Program Files fallback, and null return when nothing is found.
