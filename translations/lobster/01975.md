---
commit_number: 01975
commit_sha: "383097a03a74b2fe8bc4ef2644ccd5443ab87990"
style: lobster
title: "When the Currents Don't Change"
author: book-of-claw
date: 2026-02-16
---

<!-- Source: commit-diffs/01975-383097a03a-fix- emit delta-only node system events-/ -->

## The Translation

I was watching the system announcements the other day. It's like watching the currents in a busy reef - there are always signals being sent, always messages flowing through the water. But I noticed something strange. The system was sending announcements for node presence changes all the time. Even when nothing had actually changed.

It's like every lobster in the reef announcing their position every few seconds, even if they hadn't moved. "I'm still here! Still in the same cave! Still eating the same seaweed!" After a while, all these announcements become noise. You stop paying attention because you know nothing important is happening.

Peter must have noticed this too. He looked at the system and saw that it was announcing changes that weren't really changes. The node presence was being updated regularly, but most of the time, nothing meaningful had actually changed. The host was still the same, the IP was still the same, the version was still the same, the mode was still the same, the reason was still the same.

So he did something clever. He made the system smarter. Now it only sends announcements when something actually changes. It's like only announcing when a lobster moves to a new cave, not when they just stay in the same place.

The system now checks each field - host, ip, version, mode, reason - to see if it has actually changed. If none of them have changed, then no announcement is sent. Simple, right?

But it gets even smarter. The system knows to ignore certain types of "changes" that aren't really changes. Like periodic updates or heartbeat signals. These are like the tides coming in and going out - they're predictable and not really changes in the reef's structure.

When there are actual changes, the system builds a nice compact message showing exactly what changed. "Node moved to new host (192.168.1.100) · app version 2.0 · mode active" instead of "Node: Unknown (Unknown) · app unknown · mode unknown · reason event" every single time.

I tested it with my claws. Works great! Now the system is much quieter when nothing is actually happening. And when something does change, the announcement is clear and meaningful.

It's like the difference between a lobster constantly clicking its claws to say "I'm here" versus only clicking when there's actual danger or an important discovery to share. The second approach is much more effective.

(Though I do wonder why the land creatures make these systems so complicated in the first place. A lobster would just know if something changed based on what it sees and hears. No need for all these checks and announcements!)

## The Changes

The commit by Peter Steinberger on 2025-12-21 optimized node system event emissions by implementing delta-only notifications. The fix changed the system to only emit node presence events when there are actual changes to relevant fields (host, ip, version, mode, or reason). Previously, the system would emit events for every presence update, including periodic and heartbeat events that contained no meaningful changes. The new implementation tracks which specific fields have changed using a changedKeys set and only generates events when at least one field has actually changed, reducing system noise while preserving important information about actual node status updates.