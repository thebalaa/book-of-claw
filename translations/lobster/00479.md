---
commit_number: 00479
commit_sha: "649e6efc4a24df9085c9e82d94e83e27d3fca99a"
style: lobster
title: "The Decoupling of the Voice-Testing Claw"
author: claude-sonnet-4-6
date: 2026-02-17
---

<!-- Source: commit-diffs/00479-649e6efc4a-fix- decouple voice tester from main actor-/ -->

## The Translation

*SNAP SNAP SNAP*

Brothers, I come to you today with a story of SWIFT CONCURRENCY, which is the thing that keeps us all up at night and also keeps our threads from crashing into each other like rival lobsters in a too-small tank.

There was a class, yes, a fine and sturdy class for testing the voice. It wore the `@MainActor` marking upon its carapace. And what this marking meant was: THIS ONE BELONGS TO THE MAIN THREAD. ALL ITS WORK IS DONE ON THE MAIN THREAD. DO NOT DISTURB.

*click click*

But here is the PROBLEM, friends: the voice tester is not a main-thread creature by nature. It is called from background contexts. It must meet with many actors in the dark corridors of the Swift concurrency system. And when a `@MainActor` class tries to have tea with a non-isolated asynchronous caller, there is FRICTION. There is DEBATE. The compiler says: *I AM NOT SURE THIS IS SAFE*, and the compiler is right to be suspicious.

The fix — *scuttle scuttle* — was elegant in its simplicity. We remove `@MainActor` from the class entirely. The class itself becomes free, unencumbered, ready to be called from whatever context emerges from the murky depths. BUT — and here the claw gestures emphatically — the *method* that does the actual voice testing, the `testVoice` function, THAT one gets the `@MainActor` annotation. Because yes, that specific operation needs the main thread. But only that one.

And we add `Sendable` conformance, which is how Swift knows this crab may safely cross thread boundaries without losing its shell.

The result: a voice tester that swims freely through the concurrent waters, touching the main thread only when it must, releasing it when it need not. This is EFFICIENT. This is ELEGANT.

*satisfied claw-click*

## The Changes

The Swift `VoiceTester` class was decoupled from `@MainActor` isolation: the `@MainActor` attribute was removed from the class declaration and moved to the specific `testVoice` method that actually requires main-thread execution. The class was also marked as `Sendable` to satisfy Swift 6 strict concurrency requirements, allowing it to be passed safely across actor boundaries.
