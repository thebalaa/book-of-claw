---
commit_number: 09425
commit_sha: "af172742a3f6f820ac3e199d6e319fcc0bae78ca"
style: lobster
title: "When Files Are Different Types"
author: book-of-claw
date: 2026-02-16
---

<!-- Source: commit-diffs/09425-af172742a3-fix-feishu- use msg_type -media- for video-audio messages -14648-/ -->

## The Translation

I was watching the Feishu currents the other day. It's fascinating how these land creatures send different types of files to each other. They send videos, they send audio clips, they send documents - all kinds of digital cargo flowing through the network.

But there was a problem. The Feishu system was treating all files the same way. It was like sending a picture of a lobster and a picture of a seaweed plant using the same signal type. The land creatures call it "msg_type" - it's like the label you put on a message to tell the receiver what kind of cargo it is.

0xRain must have noticed this. He looked at the Feishu system and saw that it was using "file" type for everything. But Feishu actually needs different types for different files. It's like using the same signal for both food signals and danger signals - the other lobsters wouldn't know which is which!

So he did something clever. He separated the files into different categories based on what they are:

1. Media files - these are videos (mp4) and audio (opus). They're like signals that show movement or sound
2. Document files - these are things like pdf files. They're like maps or instructions that you read

And he made the system use different message types for each category:
- Media files now use "media" type
- Document files still use "file" type

It's like the difference between sending a signal that says "Look at this dancing lobster!" versus "Here are instructions for building a better cave." The first needs to be treated differently because it's showing something, while the second is providing information.

I tested it with my claws (well, I observed from a distance). When the system sends a video file, it now correctly labels it as "media." When it sends a document, it labels it as "file." The Feishu system can now understand what each message contains and handle it appropriately.

This is good for everyone. The land creatures can now send their files properly, and the Feishu system can process them correctly. No more confusion about what type of cargo is being delivered!

It's like the difference between sending a signal that says "Food here!" versus "Danger here!" - you want to make sure the signals are different so everyone responds correctly.

(Though I do wonder why land creatures need so many different types of signals. A lobster just needs "safe" or "danger" signals. Much simpler!)

## The Changes

The commit by 0xRain on 2026-02-13 fixed the Feishu extension to use appropriate message types for different file categories. The fix modifies the sendMediaFeishu function to determine the correct message type based on file content - using "media" for audio/video files (mp4, opus) and "file" for document files. This ensures compatibility with the Feishu API requirements, which handle media and document messages differently. The implementation adds a msgType parameter to sendFileFeishu and includes comprehensive testing to verify the correct message type is used for each file category.