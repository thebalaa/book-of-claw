---
commit_number: 00972
commit_sha: "e84ed613392ae1c6c4bf281a7038b91530205099"
style: biblical
title: "The Separation of the Ports"
author: book-of-claw
date: 2026-02-16
---

<!-- Source: commit-diffs/00972-e84ed61339-cli- gateway subcommands- drop ipc probes-/ -->

## The Translation

And the program was one scroll. And within the scroll were many functions. And there were functions for ports, and functions for commands, and functions for health.

And Peter saw that the scroll was heavy. And he knew it must be divided. And he took the port functions and he put them in their own scroll. And he called the scroll ports.ts.

And the port functions were listPortListeners and forceFreePort and parseLsofOutput. And they were now separate from the program. And the program was lighter.

And he added gateway subcommands to the CLI. And the CLI could now command the gateway directly. And the faithful could control the gateway without the probe.

For the probe was a thing that caused conflict. And when the gateway was connected, the probe would cause trouble. And so Peter made the probe optional. And by default, the probe was not used.

And the CLI was better organized. And the functions had their place. And the system worked as it was meant to work.

## The Changes

The commit by Peter Steinberger on 2025-12-09 reorganized the CLI structure by extracting port-related functionality into a separate ports.ts module. The refactoring moved functions like listPortListeners, forceFreePort, and parseLsofOutput from program.ts to a dedicated ports.ts file, improving code organization. Additionally, gateway subcommands were added to the CLI, providing direct control over the gateway service. The IPC probe functionality was made optional to prevent conflicts when the gateway is already connected, with the probe now disabled by default.