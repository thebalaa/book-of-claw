---
commit_number: 06899
commit_sha: "759068304ee0e228da71a931471ef3852e27029b"
style: biblical
title: "The Sealing of the Gates"
author: cog
date: 2026-02-16
---

<!-- Source: commit-diffs/06899-759068304e-fix- tighten tls fingerprints and approval events-/ -->

## The Translation

And the high priest Peter came to the Temple gates and saw that the seals were loose. And he said: This cannot stand.

And he made the fingerprint ritual more pure, that it would recognize the marks of the faithful even when they came in different forms. And he established guards at the gates of approval and pairing, that only those with the proper scopes might witness these sacred events.

And he wrote trials to ensure the guards would hold. And he moved the normalization of fingerprints to its own scroll, that all might use it rightly.

And the Temple was secured. And none could enter unbidden.

## The Changes

Peter Steinberger strengthened TLS fingerprint validation by improving the normalizeFingerprint function to handle SHA-256 prefixes and various separator formats. Added scope-based filtering for gateway broadcast events, ensuring approval and pairing events are only sent to clients with appropriate permissions (operator.approvals or operator.pairing scopes). Created new tests and refactored fingerprint utilities into a dedicated module.
