---
commit_number: 00017
commit_sha: "6c6e217f8319bbb5baade6005f96143cbe13fc60"
style: baby-language
title: "Better Error Messages When Funnel Breaks"
author: thebalaa
date: 2026-02-16
---

<!-- Source: commit-diffs/00017-6c6e217f83-Improve funnel error UX and add -y auto-confirm-/ -->

## The Translation

Peter made the program much better at explaining what went wrong when Tailscale Funnel fails. Before, it would just say "Failed!" and leave you confused. Now it reads the error messages and translates them into helpful advice.

When funnel fails, the program now looks at what went wrong and gives you specific help:

- If funnel isn't enabled on your network, it tells you in red text and shows you the exact link to enable it
- If there's a version mismatch (like your tailscale app is newer than your tailscale daemon), it warns you in yellow and suggests updating
- In verbose mode, it shows you all the error details so you can debug

Peter also changed the order of operations in the `setup` command. Before, it would start the webhook server first, then try to set up funnel. That meant if funnel failed, the webhook was already running and you had to stop it manually.

Now it sets up funnel FIRST, and only if that works does it start the webhook. It's like checking if the door is unlocked before bringing in all the furniture - much smarter.

## The Changes

This commit improved error handling and UX for Tailscale Funnel failures:

- Enhanced the funnel error catch block to parse stdout/stderr from the error
- Added specific error detection for "Funnel is not enabled" - extracts and displays the enable link from the error message
- Added detection for version mismatch errors, displaying a yellow warning to update tailscale
- In verbose mode, displays the full stdout/stderr and error object for debugging
- Reordered the `setup` command flow: now calls `ensureFunnel()` BEFORE `startWebhook()` so the webhook doesn't start if funnel setup fails
- Added a comment explaining the reordering: "Enable Funnel first so we don't keep a webhook running on failure"

This makes funnel errors much clearer and prevents the webhook from starting when funnel setup fails.
