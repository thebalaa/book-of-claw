---
commit_number: 00024
commit_sha: "fc5f3751426cbd88e39288ea4a686bae3fcaea83"
style: baby-language
title: "Teaching the Program to Stay Running and Stop Gracefully"
author: thebalaa
date: 2026-02-16
---

<!-- Source: commit-diffs/00024-fc5f375142-Keep setup-webhook running with waitForever and graceful SIGINT-/ -->

## The Translation

Peter fixed a problem: the webhook commands would start the server and then immediately exit. It's like opening a lemonade stand and then immediately walking away - not very useful!

Now the program knows how to stay running forever. Peter created a `waitForever()` function - it's a promise that never resolves. Think of it like an endless waiting room - the program sits there patiently, keeping the server alive, until you tell it to stop.

He also made the program stop gracefully when you press Ctrl+C. Before, pressing Ctrl+C would kill everything abruptly (like slamming a door). Now it listens for SIGINT (the technical name for Ctrl+C) and does a proper shutdown:

1. Closes the server cleanly
2. Prints "ðŸ‘‹ Webhook stopped"
3. Exits normally

Both the `webhook` and `setup` commands now return the server object (instead of returning nothing), then set up the SIGINT handler, then call `waitForever()`. This keeps the webhook alive and listening for messages until you decide to stop it.

## The Changes

This commit made webhook commands stay running properly:

- Changed `startWebhook()` return type from `Promise<void>` to `Promise<import('http').Server>`
- Made it return the actual HTTP server object instead of void
- Created `waitForever()` helper function that returns a never-resolving promise to keep the process alive
- In the `webhook` command: capture the server, add SIGINT handler for graceful shutdown, call `waitForever()`
- In the `setup` command: same pattern - capture server, add SIGINT handler, call `waitForever()`
- SIGINT handler closes the server cleanly and prints goodbye message before exiting

Now both commands properly stay running until interrupted by the user.
